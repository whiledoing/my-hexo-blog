---
date: 2018/4/21 14:21:29
tags: [ML,AI]
mathjax: true
title: Coursera - Andrew Ng - Deep Learning - å­¦ä¹ ç¬”è®°
---

ä¹‹å‰å­¦å®Œäº†[Coursera - Andrew Ng - Machine Learning][1]è¯¾ç¨‹ï¼Œå—ç›ŠåŒªæµ…ï¼Œå¯¹machine learningçš„å¾ˆå¤šæ¦‚å¿µå’Œå®é™…åº”ç”¨æœ‰äº†æ›´æ·±å…¥çš„ç†è§£ã€‚ä¸è¿‡è¿™ä¸ªè¯¾ç¨‹æ—¶é—´å·²ç»æ¯”è¾ƒä¹…äº†ï¼Œé‚£æ—¶mlçš„åº”ç”¨æƒ…å†µå’Œç°åœ¨åº”è¯¥æœ‰äº†å¤©å£¤ä¹‹åˆ«ï¼Œæ‰€ä»¥å†…å®¹ä¸Šæœ‰äº›æ»åã€‚ä¸è¿‡å…¥é—¨å­¦ä¹ çš„è¯ï¼Œè¿˜æ˜¯æ¨èçœ‹ä¸€éè¯¥è¯¾ç¨‹ã€‚è‡³å°‘ä¸æˆ‘ä¸ªäººè€Œè¨€ï¼Œè§‰å¾—æ•™çš„éå¸¸å¥½ï¼Œå­¦ä¹ å†…å®¹æ”¾åœ¨[åšå®¢][2]ä¸­ã€‚

Andrewè€å¸ˆæœ€è¿‘åˆ›åŠäº†[deeplearning.ai][3]ï¼Œä¸»é¡µä¸Šç›®å‰çš„å†…å®¹æ˜¯å…³äºdeep learningçš„è¯¾ç¨‹ã€‚è¯¾ç¨‹å†…å®¹è¿˜æ˜¯æ”¾åœ¨äº†[Coursera - Andrew Ng - Leep Learning][4]ï¼Œæ‰€ä»¥ç»§ç»­å­¦ä¹ ï¼Œè®°å½•ï¼Œæ€»ç»“ã€‚

åˆåŠï¼Œç½‘æ˜“äº‘è¯¾å ‚ä¸Šæœ‰å…è´¹çš„[ä¸“ä¸šè¯¾][5]ï¼Œä¸€æ ·çš„è¯¾ç¨‹ï¼Œè€Œä¸”ä¸Šé¢å­—å¹•æ˜¯ä¸­è‹±å¯¹ç…§çš„ï¼Œçœ‹èµ·æ¥æ¯”è¾ƒèˆ’æœï¼Œä½†æˆ‘çœ‹äº†ä¸€ä¼šå‘ç°**æ²¡æœ‰è¯¾åé—®é¢˜ï¼Œä¹Ÿæ²¡æœ‰ç¼–ç¨‹ä½œä¸š**ï¼Œæ‰€ä»¥è¿˜æ˜¯è½¬åˆ°courseraä¸Šå­¦ä¹ ã€‚å› ä¸ºæŒ‰æˆ‘ä¹‹å‰å­¦ä¹ çš„ç»éªŒï¼Œè¯¾åä¹ é¢˜å’Œç¼–ç¨‹ä½œä¸šéå¸¸é‡è¦ï¼Œç»ƒä¹ å’Œç¼–ç¨‹å®ç°å¯ä»¥æå¤§åœ°æé«˜å¯¹çŸ¥è¯†çš„ç†è§£ç¨‹åº¦ã€‚ï¼ˆcourseraä¸Šè¯¾ç¨‹ï¼Œ7å¤©å…è´¹ï¼Œåé¢æ¯æœˆä»˜è´¹49åˆ€ï¼‰

åˆåŠï¼Œdeep learningè¯¾ç¨‹è¦æ±‚ä¸å¯ä»¥å…¬å¼€ä½œä¸šä»£ç ï¼ŒåŒ…æ‹¬ä¸Šä¼ åˆ°githubï¼Œæ‰€ä»¥ä¸æ•´ç†ä»£ç äº†ã€‚:laughing:

<!--more-->

# Neural Network and Deep Learning

ä¸ºä»€ä¹ˆdeep learningè¿™å‡ å¹´ç‰¹åˆ«å‰å®³ï¼Ÿ

![image_1cbjjlpbn131l5err5d1ipbh39.png-165.5kB][6]

ä¸»è¦å½’äºï¼šæµ·é‡æ•°æ®çš„é‡‡é›†ï¼›ç®—æ³•çš„åˆ›æ–°ï¼›è®¡ç®—èƒ½åŠ›çš„æé«˜ã€‚

æ•°æ®åˆ°äº†ä¸€å®šé‡çº§æ—¶ï¼Œç¥ç»ç½‘ç»œç›¸å…³ç®—æ³•ç›¸æ¯”äºå…¶å®ƒç®—æ³•æ‹¥æœ‰ç»Ÿæ²»çº§çš„è¡¨ç°ã€‚è€Œè®¡ç®—ç¥ç»ç½‘ç»œï¼Œéœ€è¦éå¸¸å¼ºå¤§çš„è®¡ç®—èƒ½åŠ›ã€‚

æ¨¡å‹çš„è¡¨ç¤ºæ–¹æ³•å’Œä¹‹å‰å­¦åˆ°çš„ç•¥æœ‰åŒºåˆ«ï¼š

- ç¥ç»ç½‘ç»œæ¨¡å‹ä¸­å°†å¸¸é‡(bias node)ä»å‚æ•°ä¸­å»æ‰è€Œä½¿ç”¨æ–°å‚æ•°$b$ï¼Œinter-spectrumã€‚
- å•ä¸ªè¯¯å·®å‡½æ•°è®°åš$\mathcal{L}$ï¼Œlost functionï¼ŒæŸå¤±å‡½æ•°ã€‚

![image_1cbk9eq4khivnibo04st8o813.png-109.4kB][7]


ä¸Šå›¾ä½“ç°äº†å¾®åˆ†çš„çº§è”æ€§è´¨ï¼ˆåˆ†çº§å»æ€è€ƒå¾®åˆ†ç¡®å®æ›´å®¹æ˜“ç†è§£å’Œæ¨å¯¼ï¼‰ï¼Œæ¯”å¦‚ï¼š

$$ da={d\mathcal{L} \over da}=-{y\over a}+{1-y \over 1-a} $$
$$ {da \over dz}=a(1-a) $$

è¿™æ ·å­ä¸¤è€…ä¸€ç»“åˆå°±å¯å¾—åˆ°ï¼š

$$ dz={d\mathcal{L} \over da}{da \over dz}=a-y $$

å¯¹logesticæ¨¡å‹è€Œè¨€ï¼ŒåŸºæœ¬ä¸Šå°±æ˜¯ä¸Šé¢çš„å…¬å¼ï¼Œå¦‚æœè¦å†å¯¹å…·ä½“å‚æ•°æ±‚å¯¼ï¼Œå¯è¿›ä¸€æ­¥åˆ†å±‚è®¡ç®—ï¼Œå°±æ¯”è¾ƒå®¹æ˜“åˆ†æäº†ã€‚

---

pythonçš„numpyåº“è¿›è¡ŒçŸ©é˜µè¿ç®—æ—¶ï¼Œä¼šè¿›è¡Œbroadcastingæ‰©å±•ï¼Œå°±æ˜¯å°†çŸ©é˜µçš„ç»´åº¦è¿›è¡Œè‡ªåŠ¨æ‰©å±•ï¼š

![image_1cbk4ja891dfi1c531s45bhc88km.png-147kB][8]

ç®€æ´æ˜¯ç®€æ´äº†ï¼Œä½†ä½¿ç”¨æ—¶å€™ï¼Œéœ€è¦æ›´åŠ æ˜ç¡®çŸ©é˜µçš„ç»´åº¦ä¿¡æ¯ï¼Œä¸è¦ç”¨é”™äº†broadcastingã€‚

ä½¿ç”¨numpyçš„arrayï¼Œéœ€è¦ç•™æ„ï¼Œå¦‚æœæŒ‡å®šä¸€ä¸ªç»´åº¦ï¼Œé‚£ä¹ˆä¸æ˜¯çŸ©é˜µï¼Œè€Œæ˜¯æ•°ç»„ï¼Œæ¯”å¦‚`np.random.randn(5)`å¾—åˆ°çš„ä¸æ˜¯å‘é‡ï¼ˆçŸ©é˜µä¸­çš„æ¦‚å¿µï¼‰ï¼Œè€Œåªæ˜¯æ•°ç»„ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨å‘é‡ï¼Œè¦æ˜ç¡®æŒ‡å®šç»´åº¦ï¼Œæ¯”å¦‚`np.random.randn(5, 1)`ã€‚æˆ‘è§‰å¾—è¿™ä¸ªè®¾å®šæ›´å¥½ï¼Œç›¸æ¯”äºoctave/matlabä¸“é—¨ç”¨æ¥çŸ©é˜µè¿ç®—è¯­è¨€ï¼Œpythonä½¿ç”¨é¢æ›´å¹¿ï¼ŒåŒºåˆ«å¥½çŸ©é˜µå’Œæ™®é€šæ•°ç»„æ˜¾å¾—æœ‰å¿…è¦ã€‚åŒæ—¶ï¼Œæ˜ç¡®æŒ‡å®šç»´åº¦ä¹Ÿç¬¦åˆpythonçš„è®¾è®¡åŸåˆ™ï¼š**Explicit is better than implicit.**

---

ç¥ç»ç½‘ç»œçš„æ¨¡å‹è¡¨ç¤ºæ–¹æ³•ä¹Ÿç•¥å¾®å˜åŒ–äº†ä¸€äº›ï¼š

![image_1cblv2ga614fe1oeglfi17k91sng1t.png-119.1kB][9]

ä½¿ç”¨**ä¸­æ‹¬å·è¡¨ç¤ºå±‚çº§**ï¼Œè€Œ**å°æ‹¬å·ä¸­å†…å®¹è¡¨ç¤ºä¸åŒæ•°æ®**ï¼Œè¿™æ ·å­ç»Ÿä¸€äº†è¡¨ç¤ºã€‚åŒæ ·ï¼Œä½¿ç”¨å¸¸é‡å‚æ•°$b$çš„è¡¨ç°å½¢å¼æ›´ç®€æ´ã€‚

activation functionæœ‰å‡ ç§å½¢å¼ï¼š

![image_1cbm0mlpgi4v2nu11sd1jsrii2q.png-53.9kB][10]

ä¹‹å‰ä¸»è¦ä½¿ç”¨çš„sigmoidå‡½æ•°åªæœ‰åœ¨äºŒå…ƒåˆ¤å®šé—®é¢˜ä¸Šå¯èƒ½ä½¿ç”¨ï¼Œå¤§å¤šæ•°æ—¶å€™ä½¿ç”¨tanhå’ŒReLuã€‚tanhå…¶å®æ˜¯sigmoidçš„ç§»ä½å‡½æ•°ï¼Œä½†æ˜¯å¼•å…¥äº†è´Ÿæ•°ï¼Œä¸­å€¼ä¸º0ï¼Œæ•ˆæœæ›´å¥½ã€‚è€ŒReLuï¼ˆrectified linear unitï¼Œçº¿æ€§æ•´æµå‡½æ•°ï¼‰æ˜¯ä¸šç•Œä½¿ç”¨æœ€å¤šçš„ï¼Œå…¼å…·äº†æ•ˆæœå’Œè®¡ç®—æ•ˆç‡ã€‚æœ€åä¸€ç§å«åšLeaky ReLuï¼Œå˜ç§ï¼Œä½¿ç”¨ä¹Ÿä¸å¤šã€‚

ç†è§£ç¥ç»ç½‘ç»œæœ€éš¾çš„éƒ¨åˆ†å°±æ˜¯åå‘ä¼ æ’­çš„è®¡ç®—ï¼Œæœ€å¥½çš„ç†è§£æ–¹å¼æ˜¯æŒ‰ç…§åå¯¼æ•°çš„é“¾æ¥æ€§æ¥ç†è§£ï¼š

![image_1cbm44tnu76l1o8o15lbul37q37.png-138kB][11]

ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼Œè®¡ç®—å‚æ•°çš„å¯¼æ•°æ˜¯åç€è®¡ç®—çš„ï¼ˆå›¾ä¸­çš„ç›¸åº”å‡½æ•°æ˜¯sigmoidï¼‰ã€‚ä¸ºäº†æ±‚æœ€å¼€å§‹å‚æ•°å¯¹æŸå¤±å‡½æ•°$\mathcal{L}$çš„å¯¼æ•°ï¼Œå°±éœ€è¦è®¡ç®—å…¶å‰ä¸€ä¸ªå‚æ•°çš„å¯¼æ•°ï¼Œä¾æ¬¡æ¨å¯¼ï¼Œåå‘æ±‚è§£ã€‚

æœ€å…ˆæ¨ç†è¿‡ç¨‹æ—¶ï¼Œå…ˆä¸è€ƒè™‘æ•°æ®ç»´åº¦ï¼Œè€Œåªè€ƒè™‘ç‰¹å¾ç»´åº¦å’Œå±‚ç»´åº¦ï¼ˆå»æ‰å°æ‹¬å·ï¼Œä¸è€ƒè™‘æœ‰$m$ä¸ªæ•°æ®ï¼Œåªè€ƒè™‘ä¸€ä¸ªæ•°æ®å‘é‡ï¼‰ï¼Œç„¶åçŸ©é˜µæ–¹ç¨‹æ¨å¯¼å®Œæˆåï¼Œå¯ä»¥æ— ç¼çš„æ·»åŠ åˆ°æ•°æ®ç»´åº¦ã€‚æ·»åŠ æ—¶ï¼Œåªéœ€è¦å°†ç‰¹å¾å‘é‡æ¨ªå‘æ‰©å±•ï¼Œä¸æ”¹å˜ä¹‹å‰æ¨å¯¼å…¬å¼çš„çŸ©é˜µè¿ç®—æ–¹å¼ï¼ˆè®¡ç®—ç»“æœå¯¹$m$æ±‚å¹³å‡ï¼‰ã€‚è¿™æ ·å­é™ç»´åˆ†æé™ä½äº†æ¨å¯¼çš„éš¾åº¦ï¼Œä¹Ÿå¯ä»¥æƒ³çš„æ›´æ¸…æ¥šã€‚(è¿™éœ€è¦æ•°æ®çš„è¡¨è¾¾æ¨¡å¼ç»Ÿä¸€ï¼Œæ•°æ®å‘é‡éƒ½æŒ‰ç…§åˆ—è¡¨ç¤ºï¼Œå¤šæ•°æ®ï¼Œå°±æ˜¯å¤šåˆ—ï¼Œæ‰€ä»¥ä¸­é—´ç»“æœéƒ½æŒ‰ç…§è¿™ä¸ªæ¡†æ¶ç»Ÿä¸€ï¼‰

å¯¹äºä¸¤å±‚çš„ç¥ç»ç½‘ç»œï¼Œè®¡ç®—å…¬å¼æ•´ç†å¦‚ä¸‹ï¼ˆå›¾ç‰‡æˆªå–äºè¯¾ç¨‹ä½œä¸šï¼‰ï¼š

![image_1cbm7fkfdjvq6uab5pt29bd3k.png-219.8kB][12]

ä¸€å®šè¦æ³¨æ„ä¸Šé¢æ¿€æ´»å‡½æ•°çš„åŒºåˆ«ï¼Œåœ¨æœ€åä¸€å±‚æ˜¯sigmoidå‡½æ•°ï¼Œæ‰€ä»¥æ‰æœ‰$dz^{[2]}=a^{[2]}-y$ï¼ˆäºŒå…ƒåˆ¤å®šæ‰ä½¿ç”¨ï¼‰ï¼Œä½†åœ¨ä¸­é—´çš„å‡½æ•°ä½¿ç”¨çš„æ˜¯$tanh$ï¼Œå…¶å¯¼æ•°æ˜¯$g^{[1]'}(z)=1-a^2$ã€‚

å¦‚æœè€ƒè™‘å¤šå±‚ï¼Œå…¶è®¡ç®—æ¨¡å‹å¯ä»¥æŠ½è±¡ä¸ºä¸‹å›¾ï¼ˆå›¾ç‰‡æˆªå–äºè¯¾ç¨‹ä½œä¸šï¼‰

![image_1cbn03ohnh10vcv11of12rfq6q5l.png-283.7kB][13]

æ­£å‘è®¡ç®—å•å…ƒçš„ä»»åŠ¡æ˜¯æ ¹æ®$a^{L-1}$è®¡ç®—å¾—åˆ°$a^{L}$ï¼Œè€Œåå‘è®¡ç®—çš„è¿‡ç¨‹æ˜¯æ ¹æ®$da^{[l]}$è®¡ç®—å¾—åˆ°$da^{[l-1]}$ã€‚æ­£å‘è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå°†$z,W,$ç¼“å­˜ï¼Œä¾¿äºåç»­åå‘è®¡ç®—å¯¼æ•°ã€‚

å®ç°çš„æŠ€å·§æ˜¯å°†æ¯ä¸ªè®¡ç®—å‡½æ•°ï¼ˆæ­£å‘å’Œæ–¹å‘ï¼‰éƒ½**æŠ½è±¡ä¸ºä¸€ä¸ªå‡½æ•°/æ¨¡å—**ï¼š

```python
# åå‘è®¡ç®—æ ¸å¿ƒä»£ç 
# relu_backwardæ˜¯å°†å½“å‰å±‚çš„Aå’Œå½“å‰å±‚çš„Zï¼ˆactivation_cacheï¼‰åšä¸ºè¾“å…¥ï¼Œæ ¹æ®å¯¼æ•°è®¡ç®—å‡ºdZã€‚
# å†çº§è”è€ƒè™‘ï¼Œå°†å½“å‰å±‚çš„dZå’ŒåŸå§‹æ•°æ®W, b, A_prevï¼ˆlinear_cacheï¼‰ä½œä¸ºè¾“å…¥ï¼Œæ¨å‡ºdA_prevä½œä¸ºä¸‹ä¸€ä¸ªè¿­ä»£çš„è¾“å…¥æ•°æ®ã€‚
dZ = relu_backward(dA, activation_cache)
dA_prev, dW, db = linear_backward(dZ, linear_cache)
```

å®ç°NNæ¨¡å‹çš„æ³¨æ„ç‚¹å’Œ[ä¹‹å‰æ•´ç†][14]çš„å·®ä¸å¤šã€‚

---

å…¶å®æ‰€è°“çš„Deep neural networkå°±æ˜¯ç¥ç»ç½‘ç»œçš„å±‚æ•°é«˜ã€‚ä¸ºä»€ä¹ˆå±‚æ•°é«˜ç›¸å¯¹æ•ˆæœä¹Ÿæ›´å¥½ï¼Ÿ

![image_1cbmp7t75mqa10v1141p1cm576141.png-157.3kB][15]

ä¸Šå›¾ç»™å‡ºä¸€ä¸ªå¯å‘æ€§çš„è¯´æ˜ã€‚ç¥ç»ç½‘ç»œçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥çœ‹åšä¸€ç§æŠ½è±¡ä¿¡æ¯å¤„ç†å•å…ƒã€‚æ¯”å¦‚è€ƒè™‘äººè„¸è¯†åˆ«çš„æ¨¡å‹ï¼Œæœ€å¼€å§‹çš„èŠ‚ç‚¹æå–ã€Œçº¿æ®µã€ä¿¡æ¯ï¼Œåé¢èŠ‚ç‚¹æå–ã€Œç»„ä»¶ä¿¡æ¯ã€ï¼Œæœ€åç»„åˆèµ·æ¥æå–å‡ºã€Œé¢éƒ¨ã€ä¿¡æ¯ã€‚è„‘ç§‘å­¦çš„ç ”ç©¶ä¹Ÿè¡¨æ˜ï¼Œäººè„‘çš„è¯†åˆ«è¿‡ç¨‹ä¹Ÿæ˜¯åˆ†å±‚çš„ï¼Œç‚¹çº¿é¢çš„è¯†åˆ«æ–¹å¼ã€‚æ‰€ä»¥å±‚æ•°è¶Šå¤šè¶Šèƒ½æ›´å¥½çš„æ‹Ÿåˆå®é™…æ¨¡å‹ã€‚

---

hyperparameters vs parameters

![image_1cbmplc331tad1uh315nj1md81ph44e.png-61.5kB][16]

ç›¸æ¯”äº$W$è¿™ç§ç›´æ¥è®¡ç®—çš„å‚æ•°è€Œè¨€ï¼Œå¦å¤–éœ€è¦ç»™å‡ºå‡è®¾å€¼çš„å‚æ•°å«åšhyperparametersï¼ˆè¶…å‚æ•°ï¼‰ã€‚è¶…å‚æ•°å†³å®šäº†æ™®é€šå‚æ•°çš„æœ€ç»ˆç»“æœã€‚ä¸€èˆ¬è¶…å‚æ•°æ¯”è¾ƒä¾èµ–äºç»éªŒè®¾å®šï¼Œå¸¸è§çš„æ–¹æ³•æ˜¯å¤šæµ‹è¯•é›†ä¸­å‚æ•°ï¼Œæ¯”è¾ƒå¾—åˆ°æ¯”è¾ƒå¥½çš„æ•°å€¼ã€‚

---

# Improving Deep Neural Networks

## Evaluation

æ¨¡å‹è¯„ä¼°çš„æ–¹æ³•å’Œ[ä¹‹å‰çš„æ•´ç†][17]çš„å·®ä¸å¤šï¼Œä¸‹é¢æ•´ç†å†…å®¹ä¸»è¦æ˜¯ä¹‹å‰æ²¡æœ‰æ€»ç»“è¿‡æˆ–è€…çŸ¥è¯†ç»“æ„æœ‰äº›å˜åŒ–çš„å†…å®¹ã€‚

cross validation setä¹Ÿå«åšdev setã€‚åœ¨æ•°æ®é‡ä¸å¤šæ—¶ï¼Œå¯ä»¥æŒ‰ç…§60/20/20çš„æ¯”ä¾‹æ¥åˆ†é…train/dev/testé›†åˆçš„æ•°æ®æ¯”ä¾‹ã€‚ä½†åœ¨æ•°æ®å¾ˆå¤šæ—¶ï¼Œæ¯”å¦‚ä¸€ç™¾ä¸‡ï¼Œç™¾åˆ†ä¹‹ä¸€å°±æ˜¯ä¸€ä¸‡ï¼Œå¯ä»¥æŒ‰ç…§98/1/1æ¥åˆ†é…ï¼Œå¹¶ä¸éœ€è¦é‚£ä¹ˆå¤šçš„dev/testã€‚

é‡‡é›†æ•°æ®æ—¶å€™çš„ç»éªŒæ³•åˆ™ï¼š

1. trainæ•°æ®éœ€è¦æ¯”è¾ƒç²¾ç¡®ï¼Œå‡†ç¡®åº¦é«˜ã€‚
2. dev/testæ•°æ®å¯ä»¥ç›¸å¯¹ä¸ç²¾ç¡®ï¼ˆè¿™æ ·æ‰å¯ä»¥æµ‹è¯•å‡ºå­¦ä¹ çš„æ•ˆæœï¼‰
3. dev/testæ•°æ®è¦ä¿è¯åŒæ¦‚ç‡åˆ†å¸ƒï¼ˆæˆ‘ç†è§£å°±æ˜¯åŒæºçš„æ„æ€ï¼Œè¿™æ ·å­ç”¨devè°ƒæ•™çš„ç»“æœæ‰å¯ä»¥æ›´å¥½çš„ç”¨æ¥éªŒè¯testï¼Œå¦‚æœä¸¤ä¸ªä¸åŒåˆ†å¸ƒï¼Œdevçš„è°ƒæ•™ç»“æœå°±æ²¡æœ‰å¤ªå¤§æ„ä¹‰ã€‚ï¼‰

é¢å¯¹bias/varianceæ—¶çš„å¤„ç†æµç¨‹ï¼š

- å…ˆå°‘é‡æ•°æ®çœ‹æ˜¯å¦æœ‰high biasï¼Œå¦‚æœæœ‰ï¼Œå¯ä»¥æé«˜ç¥ç»ç½‘ç»œçš„å±‚çº§ï¼Œå¼•å…¥æ›´å¤šå¤æ‚çš„ç‰¹å¾ï¼Œæˆ–è€…è°ƒæ•´ç¥ç»ç½‘ç»œçš„æ¶æ„ã€‚ï¼ˆmight helpï¼‰
- è§£å†³äº†biasï¼Œçœ‹æœ‰æ²¡æœ‰varianceï¼Œå¦‚æœæœ‰ï¼Œå¯ä»¥å¼•å…¥æ›´å¤šçš„æ•°æ®ï¼Œregularizationï¼Œæˆ–è€…è°ƒæ•´ç¥ç»ç½‘ç»œæ¶æ„ï¼ˆmight helpï¼‰

![image_1cbo6rtme19a5m631qdf18ga1oo362.png-82.6kB][18]

ä»¥å‰mlç®—æ³•ä¼šè®¨è®ºã€Œbias and variance tradeoffã€ï¼Œå› ä¸ºä»¥å‰çš„ç®—æ³•æ€»æ˜¯æ— æ³•å…¼é¡¾ä¸¤è€…çš„æ•°å€¼ã€‚ä½†æ˜¯éšç€ç°åœ¨deep learningç®—æ³•çš„å…´èµ·ï¼Œåœ¨å¤§æ•°æ®å’Œå¤§ç½‘ç»œçš„æƒ…å†µä¸‹ï¼Œæ˜¯å¯ä»¥å…¼é¡¾biaså’Œvarianceï¼Œæ‰€ä»¥ç°åœ¨ä¹Ÿå°±ä¸æ€ä¹ˆætradeoffçš„äº‹æƒ…ã€‚

---

## Regularization

regularizationè®¡ç®—æ¨¡å‹ä¸­å¼•å…¥ä¸¤ä¸ªæœ¯è¯­ï¼š

![image_1cbo78s3ro0g1a7k1cdjur51l287f.png-110.4kB][19]

- Frobenius normï¼šè´¹ç½—è´å°¼ä¹Œæ–¯èŒƒå¼ï¼Œå…¶å®å°±æ˜¯ä¸€ä¸ªçŸ©é˜µæ‰€æœ‰å…ƒç´ çš„L2è·ç¦»æ±‚å’Œã€‚
- weight decay: regularizationçš„è®¡ç®—å…¶å®å°±æ˜¯ä¸€ç§weight decayï¼ŒåŸæ¥çš„weightåŠ å…¥regularizationå°±ç­‰äºå…ˆè‡ªå‡ä¸€ä¸ªæ¯”ä¾‹$1-{\alpha\lambda \over m}$

ä¸ºä»€ä¹ˆregularizationå¯ä»¥é™ä½overfittingã€‚

ä»ç½‘ç»œè®¡ç®—å¤æ‚åº¦è§’åº¦æ¥ç†è§£ï¼š

![image_1cbo7mg97rvj4qdtv216mo1p9.png-114.8kB][20]

å¦‚æœ$\lambda$è¶Šå¤§ï¼Œè§„çº¦è¶Šå¼ºï¼Œæƒé‡çŸ©é˜µæ•°å€¼è¶Šå°ï¼Œè¶Šæ¥è¿‘0ï¼Œè¿™å°±ç­‰äº**å»æ‰äº†ç¥ç»ç½‘ç»œçš„å¤æ‚èŠ‚ç‚¹**ï¼Œæ¨¡å‹è¶Šç®€å•ï¼Œè¶Šæ¥è¿‘äºçº¿æ€§æ¨¡å‹ã€‚

å¦ä¸€ä¸ªè§’åº¦å¯ä»¥ä»æ¿€æ´»å‡½æ•°ï¼ˆéçº¿æ€§ï¼‰è§’åº¦åˆ†æï¼š

![image_1cbo7uit316egjs39kr3jq17oa1m.png-80.2kB][21]

å¦‚æœ$\lambda$è¶Šå¤§ï¼Œè§„çº¦è¶Šå¼ºï¼Œæƒé‡çŸ©é˜µæ•°å€¼è¶Šå°ï¼Œè¶Šæ¥è¿‘0ï¼Œ$z$å°±è¶Šå°ï¼Œæ¿€æ´»å‡½æ•°çš„è®¡ç®—é›†ä¸­åœ¨**çº¿æ€§å¯¼æ•°åŒºé—´æ®µ**ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¨¡å‹çš„éçº¿æ€§æ¨¡å‹é€€åŒ–æˆçº¿æ€§æ¨¡å‹ã€‚

å½“ç„¶regularizationçš„ä½œç”¨ä¸æ˜¯å°†æ¨¡å‹é™ç»´çº¿æ€§ï¼Œè€Œæ˜¯æ‰¾åˆ°ä¸­é—´å€¼ï¼Œå»æ‰overfittingçš„æˆåˆ†ï¼Œè®©ç»“æœjust right

å¦å¤–ä¸€ç§regularizationçš„æ–¹æ³•æ˜¯**dropout regularization**ï¼šè®¡ç®—èŠ‚ç‚¹æ—¶**éšæœºå»æ‰ä¸€äº›èŠ‚ç‚¹çš„ç»“ç®—ç»“æœ**ï¼š

![image_1cboj4tcs2vhj1ekodkkb144j2j.png-105.4kB][22]

dropout regularizationè®¡ç®—çš„æƒ³æ³•æ˜¯ï¼šä¸è¦ä¾èµ–ä»»ä½•ä¸€ä¸ªç‰¹å¾ï¼Œé™ä½æƒé‡çš„æ–¹å·®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè®©æƒé‡åˆ†å¸ƒçš„æ›´åŠ å‡åŒ€ï¼Œè€Œä¸ä¾èµ–äºç›¸å¯¹æƒé‡è¾ƒå¤§çš„ç‰¹å¾ã€‚æ‰€ä»¥è®¡ç®—æ—¶ï¼Œéšæœºå»æ‰ä¸€äº›èŠ‚ç‚¹çš„è®¡ç®—ç»“æœï¼Œè®©æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½å¯¹æœ€åçš„æƒå€¼èµ·åˆ°å¹³å‡çš„æ•ˆæœã€‚

<center>
<video width="620" height="440" src="/videos/dropout2_kiank.mp4" type="video/mp4" controls>
</video>
</center>

è¯¾ç¨‹ä¸­è¯´æ˜ï¼Œdroupoutçš„æ–¹æ³•æ˜¯ä¸€ç§regularizationæ–¹æ³•ï¼Œåªæœ‰åœ¨æ¨¡å‹å˜å¾—overfittingçš„æ—¶æ‰è€ƒè™‘ä½¿ç”¨ã€‚åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸç”¨droupoutæ¯”è¾ƒå¤šï¼Œå› ä¸ºè§†è§‰é¢†åŸŸç‰¹å¾éå¸¸å¤šï¼Œæ‰€ä»¥åœ¨è®¡ç®—é‡æœ‰é™çš„æƒ…å†µä¸‹ï¼Œæ•°æ®å¯èƒ½æ²¡æœ‰é‚£ä¹ˆå¤šï¼Œå°±éœ€è¦dropoutçš„æ–¹å¼æ¥é™ä½overfitï¼ŒåŒæ—¶ï¼Œä¹Ÿé™ä½æƒå€¼å¯¹ç‰¹å¾çš„ä¾èµ–ã€‚ï¼ˆç‰¹å¾å¤šï¼Œä¸å¸Œæœ›æœ‰ä¸»æ¬¡ï¼‰

å…¶è®¡ç®—è¿‡ç¨‹å°±æ˜¯æ¯æ¬¡è¿­ä»£è®¡ç®—çš„æ—¶å€™éƒ½éšæœºé€‰æ‹©èŠ‚ç‚¹ï¼Œä»£ç å¤§è‡´å¦‚ä¸‹ï¼š

```python
# keep_probå‚æ•°è¡¨ç¤ºä¿ç•™çš„æ¦‚ç‡ï¼Œå¦‚æœæ˜¯1ï¼Œæ²¡æœ‰dropoutï¼Œå¦‚æœæ˜¯0.8ï¼Œ0.2ä¸¢å¤±ã€‚
# æ‰€ä»¥éšæœºé€‰æ‹©æ•°æ®ï¼Œå°äºkeep_probçš„ä¿ç•™ï¼Œè®¾ç½®ä¸º1ï¼Œå…¶ä½™è®¾ä¸º0
D = np.random.rand(A.shape[0], A.shape[1]) < keep_prob

# å°†æ•°æ®ç‚¹ä¹˜Maskçš„çŸ©é˜µDï¼Œç„¶åé™¤ä»¥keep_probï¼Œè¿™æ ·å­å¾—åˆ°ç»“æœè¿‘ä¼¼æ²¡æœ‰dropoutç»“æœ
# å› ä¸ºä½¿ç”¨dropoutæ•°å€¼å˜å°ï¼Œå†é™¤å›æ¥ï¼Œè¿‘ä¼¼åŸæ¥æ•°å€¼ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åš**inverted dropout**
A *= D/keep_prob
```

åŒæ ·ï¼Œæ ¹æ®å¯¼æ•°çš„çº§è”ç‰¹æ€§ï¼Œæ­£å‘è®¡ç®—æ—¶å€™ä¹˜ä»¥äº†ä»€ä¹ˆç³»æ•°ï¼Œåå‘è®¡ç®—æ—¶å€™å¯¼æ•°ä¹Ÿéœ€è¦ä¹˜ä»¥ä»€ä¹ˆç³»æ•°ï¼Œæ–¹å‘è®¡ç®—dropoutå¤§è‡´ä»£ç ï¼š

```python
dA *= D/keep_prob
```

éœ€è¦é¢å¤–è¯´æ˜çš„æ˜¯ï¼Œdropoutåªç”¨åœ¨training setï¼Œè€Œä¸ç”¨åœ¨dev/test setï¼Œä¸»è¦æ˜¯ç”¨åœ¨æ”¹å–„è®­ç»ƒçš„æƒé‡ç³»æ•°ï¼Œè€Œdev/testä½¿ç”¨æ²¡æœ‰æ„ä¹‰ï¼Œåè€Œå¯¼è‡´è¾“å‡ºç»“æœçš„éšæœºæ€§ã€‚

## Optimization

æ‰€è°“ä¼˜åŒ–ï¼Œå°±æ˜¯ç”¨æœ€å°‘çš„è®¡ç®—å¾—åˆ°æœ€å¥½çš„ä¸‹é™è·¯å¾„ï¼š

![image_1cbpf2kfiqv21cou13o018q61eeo9.png-411.3kB][23]

### Initialization

å¯¹æ•°æ®è¿›è¡Œnormalizationå¤„ç†ï¼ˆä¸­å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1ï¼‰å¯ä»¥æé«˜ç®—æ³•è¿è¡Œé€Ÿåº¦ï¼š

![image_1cbojoo4b1alc1euu1om51i621l1c3d.png-195.9kB][24]

æ•°æ®ç»´åº¦ä¸åŒæ—¶ï¼Œæ¢¯åº¦ä¸‹é™çš„æ•°å€¼ä¹Ÿå˜å¾—ä¸åœ¨ä¸€ä¸ªçº§åˆ«ä¸Šï¼Œè¿›è€Œå½±å“ä¸‹é™é€Ÿåº¦ã€‚

---

åˆå§‹åŒ–æƒé‡ç³»æ•°ä¹Ÿæœ‰è®²ç©¶ï¼Œä¸€ä¸ªè¦æ±‚æƒé‡æ•°å€¼å°ï¼Œä¸€ä¸ªè¦æ±‚æƒé‡æ–¹å·®å°ã€‚

å¦‚æœåˆå§‹æƒé‡æ•°å€¼æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆè®¡ç®—çš„å“åº”ä¹Ÿä¼šåå¤§ï¼Œåå¤§çš„æ¿€æ´»å¯¹åº”çš„å¯¼æ•°æ¯”è¾ƒå°ï¼Œæ¢¯åº¦è®¡ç®—çš„æ—¶å€™ä¸‹é™æ¯”è¾ƒæ…¢ï¼Œæ”¶æ•›æ…¢ã€‚ï¼ˆè€ƒè™‘back-propagationæ—¶æ¿€æ´»å‡½æ•°çš„å¯¼æ•°è¶Šå°ï¼Œå¯¹åº”ä¸‹é™æ¢¯åº¦è¶Šå°ï¼‰

å¦ä¸€ä¸ªæ˜¯æ–¹å·®è¦å°ï¼Œè¿™ç‚¹æˆ‘çš„ç†è§£æ˜¯ï¼šåœ¨æ·±å±‚ç½‘ç»œæ¨¡å‹ä¸­ï¼Œå¦‚æœæƒé‡ä¹‹é—´å·®å¼‚å¤§ï¼Œé‚£ä¹ˆç»è¿‡Lå±‚ç½‘ç»œçš„æ”¾å¤§ï¼Œä¸åŒèŠ‚ç‚¹è¾“å‡ºå‚æ•°ä¹Ÿæ¯”è¾ƒå¤§ï¼Œè¿›è€Œå¯¼è‡´æ”¶æ•›çš„ç»´åº¦ä¸ä¸€æ ·ï¼Œå½±å“æ”¶æ•›é€Ÿåº¦ï¼ˆè€ƒè™‘ä¸Šé¢è¯´normalizationæ—¶è´´çš„å›¾ï¼‰ã€‚è¯¾ç¨‹ä¸­å½¢å®¹è¿™ä¸ªç°è±¡å«åšvanishing/exploding gradientsï¼Œå°±æ˜¯åœ¨æ¿€æ´»æ•°å€¼æå¤§å’Œæå°æ—¶ï¼Œéƒ½ä¼šå‡ä½æ¢¯åº¦çš„è®¡ç®—é€Ÿåº¦ã€‚

æ¢ä¸€ä¸ªå¯å‘çš„ç†è§£æ–¹å¼â€”â€”å¦‚æœä¸€ä¸ªäººå­¦ä¹ ä¸€ä¸ªä¸œè¥¿ï¼Œä¸Šæ¥å…¶æŒæ¡äº†å¤§å¤šæ•°çŸ¥è¯†ï¼ˆæƒé‡å¤§ï¼‰æˆ–è€…å­˜åœ¨æŒæ¡ç¨‹åº¦å·®å¼‚å¤§çš„çŸ¥è¯†ï¼ˆæœ‰äº›å­¦çš„ç‰¹åˆ«å¥½ï¼Œæœ‰äº›ç‰¹åˆ«å·®ï¼‰ï¼Œäººå†å»å­¦ä¹ çš„åŠ¨åŠ›å°±ä¼šå°å¾ˆå¤šã€‚ä¸€æ–¹é¢å¯èƒ½è§‰å¾—æ²¡å•¥è¿›æ­¥ï¼Œä¸€æ–¹é¢è§‰å¾—å­¦ä¹ è¾¹é™…æ”¶ç›Šå¤ªä½ï¼ˆå› ä¸ºæœ‰äº›å­¦çš„å¤ªå¿«ï¼Œå­¦çš„æ…¢çš„å°±æ˜¯å½±å“æƒ…ç»ªï¼‰ã€‚æ‰€ä»¥ï¼Œè¿˜æ˜¯ä»ä¸€å¼ å‡åŒ€çš„ç™½çº¸çš„çŠ¶æ€å‡ºå‘æ¥å­¦ä¹ æ•ˆæœæ›´å¥½ã€‚

ç»éªŒçš„è®¡ç®—æ–¹æ³•ï¼š

![image_1cbokft2i6nf62m2t1757g293q.png-206.4kB][25]

åˆå§‹åŒ–æƒé‡æ—¶ï¼Œæ•°æ®æŒ‰ç…§$W^{[l]} \sim \mathcal{N}(0, \sqrt{2 \over n^{[l-1]} })$åˆ†å¸ƒå–å€¼ï¼ˆæ¿€æ´»å‡½æ•°ä¸ºReLuï¼Œè¿™ä¸ªæ–¹æ³•å«åšHe Initializationï¼‰

### Mini-batch Gradient descent

å…³äºmini-batchï¼Œåœ¨ä¹‹å‰çš„[æ–‡ç« ][26]ä¸­ä¹Ÿæ•´ç†è¿‡ï¼Œå…¶æœ¬è´¨å°±æ˜¯å°†æ•°æ®åˆ†ç‰‡è¿›è¡Œè®­ç»ƒï¼Œè¿­ä»£ã€‚

![image_1cbpf5r8k1e2t24p1ejn1arv17eum.png-151.1kB][27]

![image_1cbpf7gsh14sg6jrarj95j1gmt1j.png-99.9kB][28]

å¦‚æœåªä½¿ç”¨ä¸€ä¸ªæ•°æ®è®­ç»ƒï¼Œå«åšSGDï¼Œstochastic gradient descentï¼Œä¸‹é™çš„å™ªå£°æ¯”è¾ƒå¤§ã€‚å¦‚æœå…¨å±€è¿ç®—ï¼Œå«åšbatch gradient descentï¼Œé€Ÿåº¦æ…¢ã€‚æ‰€ä»¥mini-batchçš„æ•ˆæœå±…äºä¸¤è€…ä¹‹é—´ã€‚åœ¨å¤§æ•°æ®æ·±åº¦å­¦ä¹ é¢†åŸŸï¼ŒåŸºæœ¬éƒ½æ˜¯mini-batchã€‚

æ¯ä¸€æ¬¡è¿­ä»£å®Œæ‰€æœ‰çš„æ•°æ®å«åšepochï¼›ä½¿ç”¨2çš„å€æ•°ä½œä¸ºåˆ†ç‰‡çš„å¤§å°ã€‚

### Gradient descent with Momentum

å…ˆä»‹ç»ä¸€ç§å¯¹æ—¶é—´åºåˆ—æ•°æ®å»å™ªçš„æ–¹æ³•Exponentially Weighted Avaragesï¼š

![image_1cbpfv6tq1ufrsklfmc1opdgoa20.png-213.7kB][29]

å…¶ä¸­ï¼Œ$\theta_t$è¡¨ç¤ºtæ—¶åˆ»çš„æ•°æ®ï¼Œ$v_t$è¡¨ç¤ºtæ—¶åˆ»**æŒ‡æ•°åŠ æƒçš„æ•°æ®**ï¼Œå‚æ•°$\beta$è¯´æ˜äº†åŠ æƒçš„ç³»æ•°ã€‚ç¨åŠ æ¨å¯¼å¯ä»¥å¾—åˆ°

$$\sum_{i=0}^{t}{\beta^{t-i}{(1-\beta)}\theta_i}$$

ä¹‹æ‰€ä»¥å«åšæŒ‡æ•°åŠ æƒï¼Œæ˜¯å› ä¸ºè¶Šè¿œç¦»tçš„æ•°æ®å½±å“ç³»æ•°æŒ‡æ•°é€’å‡ã€‚$v_t$çº¦ç”±å‰$1 \over {1-\beta}$ä¸ªæ—¶åˆ»çš„æ•°æ®åŠ æƒå¾—åˆ°ç»“æœï¼Œå› ä¸ºåˆ°åé¢çš„å½±å“å°±å¾®ä¹å…¶å¾®äº†ã€‚æ•…$\beta$è¶Šå¤§ï¼Œæ•°æ®è¶Šå¹³æ»‘ã€‚

ä¸Šè¿°å…¬å¼å­˜åœ¨ä¸€ä¸ªé—®é¢˜â€”â€”åˆå§‹è®¡ç®—çš„å‰å‡ ä¸ªèŠ‚ç‚¹å› ä¸ºæ²¡æœ‰ä¹‹å‰æ•°æ®å¯ä»¥åŠ æƒï¼Œæ‰€ä»¥è®¡ç®—ç»“æœæ¯”è¾ƒå°ã€‚è€Œä¸€æ—¦è¿‡äº†å¯åŠ¨é˜¶æ®µï¼Œå°±æ²¡æœ‰é—®é¢˜ã€‚è€ƒè™‘å›¾ä¸­ç´«è‰²çš„çº¿ã€‚è§£å†³æ–¹æ³•æ˜¯å¯¹æ•°æ®è¿›è¡Œæ ¡æ­£ï¼š

$$v_t^{corrected} = {v_t \over {1-\beta^t}}$$

å°†è¿™ä¸ªæ¦‚å¿µå¼•å…¥æ¢¯åº¦è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥è¿‡æ»¤æ‰å› ä¸ºmini-batchæ‰€å¯¼è‡´çš„å™ªå£°ï¼š

![image_1cbph9agsv6g1obemg87bl1foa2d.png-217kB][30]

$$ \begin{cases}
v_{dW^{[l]}} = \beta v_{dW^{[l]}} + (1 - \beta) dW^{[l]} \\
W^{[l]} = W^{[l]} - \alpha v_{dW^{[l]}}
\end{cases}$$

$$\begin{cases}
v_{db^{[l]}} = \beta v_{db^{[l]}} + (1 - \beta) db^{[l]} \\
b^{[l]} = b^{[l]} - \alpha v_{db^{[l]}}
\end{cases}$$

å¯ä»¥ç”¨ç‰©ç†å­¦çš„å†²é‡æ¦‚å¿µæ¥è¾…åŠ©ç†è§£ï¼Œå½“æ–½åŠ ä¸€ä¸ªæ–°çš„åŠ é€Ÿåº¦æ—¶ï¼ŒåŠ é€Ÿåº¦ä¸ä¼šç¬é—´æ”¹å˜é€Ÿåº¦æ–¹å‘è€Œæ˜¯å’Œä¹‹å‰é€Ÿåº¦è¿›è¡Œèåˆã€‚

### Adam optimization algorithm

å¦å¤–ä¸€ä¸ªè§„çº¦æ¢¯åº¦çš„æ–¹æ³•æ˜¯å¯¹æ•°æ®çš„å¹³æ–¹è¿›è¡ŒæŒ‡æ•°åŠ æƒï¼Œå«åšRMSpropã€‚

Adamç®—æ³•å°†momentumå’ŒRMSpropç»“åˆèµ·æ¥ä¸€èµ·ä¼˜åŒ–ï¼š

$$\begin{cases}
v_{dW^{[l]}} = \beta_1 v_{dW^{[l]}} + (1 - \beta_1) \frac{\partial \mathcal{J} }{ \partial W^{[l]} } \\
v^{corrected}_{dW^{[l]}} = \frac{v_{dW^{[l]}}}{1 - (\beta_1)^t} \\
s_{dW^{[l]}} = \beta_2 s_{dW^{[l]}} + (1 - \beta_2) (\frac{\partial \mathcal{J} }{\partial W^{[l]} })^2 \\
s^{corrected}_{dW^{[l]}} = \frac{s_{dW^{[l]}}}{1 - (\beta_2)^t} \\
W^{[l]} = W^{[l]} - \alpha \frac{v^{corrected}_{dW^{[l]}}}{\sqrt{s^{corrected}_{dW^{[l]}}} + \varepsilon}
\end{cases}$$

ç»éªŒä¸Šï¼Œè®¾ç½®$\beta1=0.9$ï¼Œ$\beta2=0.999$ã€‚å‚æ•°$\epsilon$æ˜¯ä¸ºäº†ä¿è¯åˆ†æ¯ä¸ä¸º0ï¼Œä¸€èˆ¬è®¾ä¸º1e-8ã€‚

ç›´è§‚ä¸Šç†è§£è¯¥ç®—æ³•å°±æ˜¯å¯¹$dw$è¿›è¡Œé™å™ªï¼Œå°†æ•°æ®å˜å¾—å¹³æ»‘ï¼ŒåŒæ—¶å¯¹è¿åŠ¨å¹…åº¦è¿›è¡Œä¿®æ­£ã€‚æ•°å­¦å…¬å¼ä¸Šçœ‹ï¼Œåˆåƒæ˜¯å¯¹æ•°æ®è¿›è¡Œnormalizationã€‚

### Learning rate decay

$\lambda$æ˜¯æœ€ä¸»è¦è°ƒçš„hyperparameterä¹‹ä¸€ã€‚åœ¨å¼€å§‹é˜¶æ®µï¼Œæ¢¯åº¦ä¸‹é™è¾ƒå¿«ï¼Œä½†åˆ°äº†è¿­ä»£åæœŸï¼Œæ•°æ®å·²ç»æ¥è¿‘æœ€ä¼˜è§£ï¼Œå¦‚æœ$\lambda$è¿˜æ˜¯è¿‡å¤§ï¼Œå¯èƒ½å½±å“æ”¶æ•›ã€‚åŸºäºè¿™ä¸ªæ€è·¯ï¼Œå½“è¿­ä»£åˆ°åæœŸæ—¶ï¼Œç¼©å°$\lambda$

$$\lambda = {1 \over {1+{decay\_rate}*{epoch\_num}}}$$

### Hyperparameter tuning

åœ¨æ•°æ®é‡ä¸å¤šçš„æƒ…å†µä¸‹ï¼Œå¯¹æ‰€æœ‰çš„hyperparameterè¿›è¡Œgrid searchæ˜¯å¯ä»¥æ¥å—çš„ï¼Œå› ä¸ºå•æ¬¡è¿è¡Œæ—¶é—´å¹¶ä¸å¤šï¼Œå¯ä»¥å¯¹æ‰€æœ‰çš„å‚æ•°è¿›è¡Œæ‰«åœ°å¼æœç´¢ï¼Œä½†åœ¨å¤§æ•°æ®æƒ…å†µä¸‹ä¸ç°å®ï¼Œè€Œæ˜¯ä½¿ç”¨**éšæœºçŒœæµ‹**çš„æ–¹å¼è®­ç»ƒæ¨¡å‹ã€‚å› ä¸ºäº‹å…ˆè°ä¹Ÿä¸çŸ¥é“åˆ°åº•åº”è¯¥ç”¨ä»€ä¹ˆå‚æ•°ï¼ŒéšæœºçŒœæµ‹å¯ä»¥æ›´å¿«ç”¨ä¸åŒç»„åˆè¿›è¡Œè®¡ç®—ï¼Œè¿›è€Œå¯ä»¥æ›´è¿›ä¸€æ­¥ç¼©å°éšæœºèŒƒå›´ã€‚

è°ƒæ•´å‚æ•°çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„å‚æ•°çš„scaleç­–ç•¥ã€‚å¦‚æœå¯¹$n^{[l]}$è¿›è¡ŒçŒœæµ‹ï¼Œå¯èƒ½çº¿æ€§çš„éšæœºå‡½æ•°å°±å¯ä»¥å¾—åˆ°å¥½çš„ç»“æœã€‚ä½†æ˜¯å¯¹äº$\lambda$ç³»æ•°ï¼Œçº¿æ€§ç¼©æ”¾å¾ˆéš¾å–åˆ°0.01,0.001è¿™ç±»æ•°å€¼ï¼Œä½†è¿™äº›æ•°å€¼å¯¹ç»“æœæ˜¯æœ‰å½±å“çš„ï¼Œæ‰€ä»¥ä½¿ç”¨æŒ‡æ•°ç¼©æ”¾ï¼š

![image_1cbrb8m011brs1l0924j6s01kqr3k.png-150.5kB][31]

æŒ‡æ•°å‡½æ•°çš„è¾“å…¥è¶Šå°ï¼Œæ›²ç‡è¶Šä½ï¼Œè¿™å°±ä½¿å¾—å‡åŒ€é‡‡æ ·çš„è¾“å…¥ï¼Œå¯¹åº”çš„è¾“å‡ºå¹¶ä¸å‡åŒ€ã€‚æ‰€ä»¥åœ¨æ•°æ®æ¯”è¾ƒå°æ—¶ï¼Œä¹Ÿå¯ä»¥ä¿è¯è¾“å‡ºæ•°æ®èŒƒå›´è¾ƒå°ï¼Œè¿™å°±å¯ä»¥æœ‰æ•ˆåœ°å–åˆ°0.01,0.001è¿™æ ·çš„æ•°å€¼ã€‚

## Batch Normalization

è¿™ä¸ªæ–¹æ³•éå¸¸é‡è¦ï¼Œå¯ä»¥æœ‰æ•ˆçš„æé«˜æ”¶æ•›é€Ÿåº¦ï¼Œç”šè‡³æ”¹å–„æ¨¡å‹æ•ˆæœã€‚

è¯¾ç¨‹ä¸­è´´äº†ä¸€å¼ å›¾æ¥è¯´æ˜Batch Normalizationå¯ä»¥æœ‰æ•ˆå·¥ä½œçš„åŸå› ï¼š

![image_1cbrbln261n1t18qmdfpsve1sos41.png-333.9kB][32]

å¦‚æœæˆ‘ä»¬ä¸€ç›´ç”¨é»‘çŒ«æ¥è®­ç»ƒã€Œæ˜¯å¦æ˜¯çŒ«ã€çš„ç½‘ç»œï¼Œå¹¶ä¸èƒ½ç”¨æ¥æµ‹è¯•å½©è‰²çŒ«ã€‚åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¯´ï¼Œåˆ†å‰²é»‘çŒ«è¿˜æ˜¯å½©è‰²çŒ«çš„å†…éƒ¨ã€Œé€»è¾‘ã€åº”è¯¥æ˜¯ä¸€è‡´çš„ï¼Œåªæ˜¯å› ä¸ºæ•°æ®çš„åˆ†å¸ƒå­˜åœ¨äº†ä¸€å®šçš„åç§»ï¼Œå¯¼è‡´è¾“å‡ºæ¨¡å‹çš„åç§»ï¼Œè¿™ä¸ªå«åšã€ŒCovariance Shiftã€ã€‚æ‰€ä»¥ä¸ºäº†è®©æ¨¡å‹çš„è¾“å‡ºä¸ä¾èµ–äºå…·ä½“çš„åç§»ï¼Œå°±éœ€è¦å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–ã€‚

å…¶å®åœ¨é¢„å¤„ç†ç¯èŠ‚å°±å¯¹è¾“å…¥æ•°æ®è¿›è¡Œäº†æ ‡å‡†åŒ–ï¼Œä½†è¿™é‡Œæ˜¯å¯¹è¾“å…¥æ‰‹è¿›è¡Œæ ‡å‡†åŒ–ï¼Œè€ŒBatch Normalizationæ˜¯å¯¹**éšè—èŠ‚ç‚¹çš„è¾“å‡ºæ•°æ®**è¿›è¡Œæ ‡å‡†åŒ–ã€‚æ¢å¥è¯è®²ï¼Œæ˜¯å¯¹æ¨¡å‹è¾“å‡ºçš„é«˜é˜¶ä¿¡æ¯è¿›è¡Œæ ‡å‡†åŒ–ã€‚

å°†æ¯ä¸ªéšè—å±‚èŠ‚ç‚¹çš„è¾“å‡ºçœ‹æˆä¸€ä¸ªéšæœºå˜é‡ï¼Œå¯¹å…¶è¿›è¡Œç»Ÿè®¡åˆ†æï¼Œå¾—åˆ°å…¶æ ‡å‡†å·®å’Œæ–¹å·®ï¼Œç„¶åå½’ä¸€åŒ–å¯¹åº”èŠ‚ç‚¹ï¼Œè¿™å°±æ˜¯Batch Normalizationçš„è®¡ç®—åŸç†ï¼š

![image_1cbrcd71v6fv3ve1sra1niq1c0g4e.png-95.5kB][33]

å…¶è®¡ç®—è¿‡ç¨‹ï¼š

- å¯¹mä¸ªæ•°æ®ï¼ˆmini-batchsizeï¼‰è®¡ç®—å¾—åˆ°çš„$z$ç»Ÿè®¡å‡å€¼å’Œæ–¹å·®ã€‚
- å¯¹æ•°æ®è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ã€‚
- å†å°†æ•°æ®çš„å‡å€¼æ‰©å±•åˆ°$\beta$ï¼Œæ–¹å·®æ‰©å±•åˆ°$\gamma$ã€‚åªæ‰€ä»¥è¿˜éœ€è¦æ‰©å±•æ˜¯å› ä¸ºæ•°æ®çš„ã€Œå†…éƒ¨é€»è¾‘ã€æœ¬èº«æ˜¯æœ‰ä¸€ä¸ªåˆ†å¸ƒå­˜åœ¨ï¼›å¦å¤–ï¼Œä»æ¿€åŠ±å‡½æ•°è§’åº¦è€ƒè™‘ï¼Œå¦‚æœæ•°æ®éƒ½æ˜¯$\mathcal{N}(0, 1)$åˆ†å¸ƒï¼Œæ¿€åŠ±çš„èŒƒå›´å¤ªæœ‰é™ï¼Œç”šè‡³é€€åŒ–ä¸ºçº¿æ€§æ¨¡å‹ã€‚
- å°†å‚æ•°$\gamma$å’Œ$\beta$æ”¾åˆ°è®¡ç®—æµç¨‹ä¸­ï¼Œçœ‹åšå’Œ$W$ä¸€æ ·çš„å‚æ•°è¿›è¡Œæ±‚è§£ï¼ˆæ³¨æ„è¿™é‡Œçš„$\gamma$å’Œmomentumä¸­çš„å‚æ•°ä¸ä¸€æ ·ï¼‰

æ”¾åˆ°ç¥ç»ç½‘ç»œè®¡ç®—æµç¨‹ä¸­å°±æ˜¯ï¼š

![image_1cbrdinvm65ofmn1k9e1jbq9j65o.png-253.8kB][34]

æˆ‘ä¸ªäººç†è§£ï¼Œå…¶è®¡ç®—æœ¬è´¨å°±æ˜¯åœ¨æ‹Ÿåˆé«˜é˜¶ä¿¡æ¯(çŸ¥è¯†)çš„æ ¸å¿ƒé€»è¾‘ï¼Œè€Œå»æ‰äº†å¤–åœ¨çš„å¹²æ‰°ã€‚æ¯”å¦‚ï¼Œé»‘çŒ«å½©çŒ«é—®é¢˜ï¼Œåˆ†è¾¨çŒ«è¿™ä»¶äº‹æƒ…ä¸åº”è¯¥è®©é¢œè‰²ä½œä¸ºå¹²æ‰°å› ç´ ï¼Œæ‰€ä»¥å°†é«˜é˜¶èŠ‚ç‚¹è¿›è¡Œæ ‡å‡†åŒ–ï¼Œæ‹Ÿåˆå‡ºä¸€ç§ä¸ä¾èµ–å¤–åœ¨å¹²æ‰°å› ç´ çš„æ¨¡å‹ã€‚æœ¬è´¨ä¸Šï¼Œnormalizationå°±æ˜¯å»å™ªï¼Œç»Ÿä¸€æ ‡å‡†ï¼Œé€è¿‡ã€Œç°è±¡çœ‹æœ¬è´¨ã€ã€‚

## Softmax Regression

å¯¹å¤šç±»åˆ«å›å½’é—®é¢˜ï¼Œä½¿ç”¨softmaxå‡½æ•°ä½œä¸ºæœ€åä¸€å±‚çš„æ¿€åŠ±å‡½æ•°ã€‚å…¶è®¡ç®—è¿‡ç¨‹æ˜¯å¯¹æœ€åä¸€å±‚çš„æ•°æ®è¿›è¡ŒæŒ‡æ•°è¿ç®—ï¼Œ$exp(z^{[l]})$ï¼Œç„¶åé™¤ä»¥æ€»å’Œå¾—åˆ°åŠ æƒæ¯”ä¾‹ï¼š

![image_1cbrdsdke9rn10s01ki8tcb1fcj65.png-171.7kB][35]

ä¹‹æ‰€ä»¥å«åšsoftmaxæ˜¯å› ä¸ºå…¶è®¡ç®—çš„æ˜¯ç»è¿‡è§„çº¦åŒ–åçš„æ¦‚ç‡æœ€å¤§å€¼ï¼Œè€Œä¸æ˜¯å®é™…çš„maxè¿ç®—ï¼ˆhard maxï¼‰ã€‚ä¹Ÿå¯ä»¥çœ‹å‡ºlogesticæ˜¯softmaxåœ¨äºŒå…ƒåˆ¤å®šæ—¶çš„ç‰¹ä¾‹ã€‚

softmaxçš„è¾“å‡ºç»“æœå°±æ˜¯$\hat{y}$ï¼Œç”¨æ¥ç»Ÿè®¡æœ€åçš„lossï¼š

![image_1cbre3l0716i076214ectchkja6i.png-204.1kB][36]

# Structuring Machine Learning Projects

## ML Strategy

è¿™é‡Œè¯´çš„å¾ˆå¤šå†…å®¹å’Œä¹‹å‰è¯¾ç¨‹ä¸­å­¦åˆ°çš„[å†…å®¹][37]å·®ä¸å¤šï¼Œå°±æ˜¯å¦‚ä½•è¯„ä¼°ä½ çš„æ¨¡å‹ï¼Œå¦‚ä½•è¿›è¡Œæ¨¡å‹çš„æ¯”è¾ƒå’Œç»“æœçš„åˆ†æã€‚

ä¸€ä¸ªå¤§çš„æŒ‡å¯¼åŸåˆ™æ˜¯ï¼šæ­£äº¤åŒ–ï¼ˆorthogonalizationï¼‰ã€‚æ¯æ¬¡è°ƒæ•´æ–¹æ³•åªå½±å“ç»“æœçš„ä¸€ä¸ªæ–¹é¢ï¼Œè€Œä¸æ˜¯ä¸€æ¬¡è°ƒæ•´å¤šä¸ªã€‚

å¦å¤–å°±æ˜¯è¦å»ºç«‹è¯„ä¼°çŸ©é˜µï¼ˆevaluation matricsï¼‰ï¼Œå°†ç›¸å…³å½±å“çš„æŒ‡æ ‡éƒ½åˆ—å‡ºæ¥ï¼Œä½†æœ€é‡è¦çš„æ˜¯å»ºç«‹one single valueçš„è¯„ä»·æŒ‡æ ‡ï¼Œè¯¥æŒ‡æ ‡å¯ä»¥ç»¼åˆæ‰€æœ‰è¯„ä»·å› ç´ çš„æƒé‡ã€‚å•ä¸€çš„æŒ‡æ ‡çš„ç›®çš„æ˜¯å¯ä»¥æ›´ç›´è§‚å’Œå¿«é€Ÿçš„æ¯”è¾ƒå‡ºç»“æœå¥½åã€‚

devå’Œtestçš„é›†åˆéœ€è¦åˆ†å¸ƒåŒæºã€‚è¿™ç‚¹ä¸Šæ–‡æåˆ°è¿‡ï¼ŒåŒæºæ‰å¯ä»¥ä¿è¯ç›®æ ‡ä¸€è‡´ã€‚ç”¨devè°ƒæ•´çš„ç›®æ ‡å’Œtestæ˜¯ä¸€æ ·çš„ï¼Œå¦åˆ™ç”¨devä¼˜åŒ–äº†åŠå¤©ï¼Œåˆ°testå‘ç°ç›®æ ‡å°±é”™äº†ã€‚dev/testæ•°æ®é›†åˆè¿˜éœ€è¦åŒ…å«å¯é¢„ä¼°åˆ°çš„æœªæ¥å®é™…åº”ç”¨åœºæ™¯æ•°æ®ï¼Œè¿™æ ·å­è®­ç»ƒçš„æ¨¡å‹æ‰èƒ½æ›´å¥½çš„æ‰©å±•åˆ°çœŸå®åº”ç”¨åœºæ™¯ã€‚

å¦å¤–è¯´åˆ°å¾ˆå¤šçš„ä¸€ç‚¹å°±æ˜¯è¯„ä¼°äººç±»çš„è¡¨ç°ï¼ˆhuman-level performanceï¼‰ï¼Œè¿™ç‚¹å¯¹äºåˆ†ææ¨¡å‹çš„ç»“æœæœ‰å¾ˆå¤§çš„æ„ä¹‰ã€‚

å…ˆè¯´æ˜ä¸€ä¸ªæ¦‚å¿µâ€”â€”æ¨¡å‹æ‰€èƒ½è¾¾åˆ°çš„ç†è®ºæœ€ä½è¯¯å·®å«åšBayes (optimal) errorï¼Œæˆ‘ä»¬è®­ç»ƒæ¨¡å‹çš„è¯¯å·®ä¸å¯èƒ½ä½äºBayes errorï¼Œä½†å´æœ‰å¯èƒ½é«˜äºhuman errorã€‚ä½†ä¸€èˆ¬è€Œè¨€ï¼Œåœ¨æˆ‘ä»¬çš„æ¨¡å‹æ²¡æœ‰è¶…è¿‡äººç±»ä¹‹å‰ï¼Œä¼šå°†äººç±»è¯¯å·®è¿‘ä¼¼è®¤ä¸ºæˆBayes erroræ¥è¿›è¡Œæ¨¡å‹åˆ†æï¼š

![image_1cbrpccuh7i52sm1m81790hct7c.png-158.1kB][38]

è€ƒè™‘çŒ«è¯†åˆ«é—®é¢˜ï¼Œå¦‚æœäººç±»è¯†åˆ«çŒ«çš„è¯¯å·®æ˜¯1%ï¼Œé‚£ä¹ˆ8%çš„training erroræ˜æ˜¾å°±æ¯”è¾ƒå¤§ï¼Œä¸¤è€…çš„å·®å€¼å«åšã€Œavoidable biasã€ã€‚å› ä¸ºæœ‰7%çš„avoidable errorï¼Œæ‰€ä»¥éœ€è¦å…ˆè§£å†³biasçš„é—®é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬çš„æ¨¡å‹ç¦»äººç±»çš„æ ‡å‡†éƒ½è¿˜å·®ä¸å°‘ã€‚ä½†å¦‚æœhunman erroræ˜¯7.5%ï¼Œé‚£ä¹ˆè™½ç„¶training eroræœ‰8%ï¼Œä½†æˆ‘ä»¬æ›´åº”è¯¥ä¼˜å…ˆè§£å†³varianceã€‚human erroræ˜¯è¯¯å·®åˆ†æçš„åŸºå‡†ã€‚

ä¸‹å›¾è¯´æ˜äº†æ¶ˆé™¤ç›¸å…³è¯¯å·®(bias/variance)çš„ä¸»è¦æ–¹æ³•ï¼š

![image_1cbrqgrnq7pr1j76fep8cts3p86.png-46.6kB][39]

æœ€åéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œåœ¨deep mlçš„ä¸€äº›é¢†åŸŸï¼ˆå°¤å…¶æ˜¯æ•°æ®æ›´åŠ ç»“æ„åŒ–çš„é—®é¢˜é¢†åŸŸï¼‰ï¼Œæœºå™¨å­¦ä¹ å·²ç»è¶…è¿‡äº†äººç±»ã€‚:cry:

## Error Analysis

é”™è¯¯åˆ†æçš„æœ¬è´¨æ˜¯è¦é‡ç‚¹é—®é¢˜é‡ç‚¹åˆ†æï¼Œå¯¹äºNNç½‘ç»œè€Œè¨€ï¼Œä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ–¹æ³•æ˜¯å¯¹é”™è¯¯è®¡ç®—çš„æ•°æ®è¿›è¡Œç»Ÿè®¡:

![image_1cbt9ov0tcv6fai1ks21h981oavag.png-66.2kB][40]

å¯¹ä¸åŒç§ç±»çš„é”™è¯¯è¿›è¡Œç»Ÿè®¡åˆ†æï¼Œä¼˜å…ˆä¿®å¤æ¯”ä¾‹å¤§çš„é—®é¢˜ã€‚æ¯”å¦‚è¿™é‡Œå›¾åƒæ¨¡ç³Šä¼šå¾ˆå¤§çš„å½±å“è¯†åˆ«æ•ˆæœï¼Œå°±å¯ä»¥è€ƒè™‘**åˆæˆä¸€äº›æ¨¡ç³Šå›¾åƒ**åˆ°è®­ç»ƒé›†åˆä¸­ã€‚

é¢å¤–è¯´æ˜çš„æ˜¯ï¼Œé”™è¯¯æ ‡è¯†çš„æ•°æ®æ˜¯å¾ˆæœ‰å¯èƒ½å­˜åœ¨çš„ã€‚å¯¹äºè®­ç»ƒé›†åˆè€Œè¨€ï¼Œé”™è¯¯æ ‡è¯†æ•°æ®å¦‚æœç”±éšæœºè¯¯å·®å¯¼è‡´ï¼Œé—®é¢˜ä¸å¤§ï¼ˆç³»ç»Ÿæ€§çš„é”™è¯¯æ ‡è¯†å°±æœ‰é—®é¢˜ï¼‰ï¼Œå¯ä»¥ä¸ç€æ€¥ä¿®å¤ã€‚è€Œdev/testè®­ç»ƒé›†åˆå‡ºç°é”™è¯¯æ ‡è¯†å¯ä»¥è€ƒè™‘å¤„ç†ï¼Œå› ä¸ºä¸€å®šç¨‹åº¦ä¸Šå½±å“äº†è¯¯å·®åˆ†æï¼ˆæ¯”å¦‚å’Œhuman-levelè¿›è¡Œæ¯”è¾ƒï¼‰

## Arrangement for dev/test set

åˆ†é…dev/testé›†åˆçš„æ•°æ®å…¶å®å¾ˆæœ‰è®²ç©¶ã€‚ä¸€æ–¹é¢æˆ‘ä»¬è¦ä¿è¯dev/testæ•°æ®åŒæºï¼Œå¦ä¸€æ–¹é¢è¦ä¿è¯dev/testçš„ç›®æ ‡æœ‰å®é™…æ„ä¹‰ï¼Œå¯ä»¥æ›´å¥½çš„ä½“ç°æ ¸å¿ƒåœºæ™¯ï¼Œæ ¸å¿ƒæ•°æ®çš„æ‹Ÿåˆæ•ˆæœã€‚

æ¯”å¦‚è€ƒè™‘è¯†åˆ«çŒ«çŒ«çš„åº”ç”¨ï¼Œå¦‚æœæœ‰200,000å›¾ç‰‡æ˜¯é«˜æ¸…ç½‘ç»œå›¾ç‰‡ï¼Œ10,000æ˜¯ç”¨æˆ·æ‹æ‘„çš„æ¨¡ç³Šçš„å™ªå£°å¤§çš„å›¾ç‰‡ï¼Œåº”è¯¥å¦‚ä½•åˆ†é…ï¼š

![image_1cbt9nvqk1l3j9vq1guubmhudg8j.png-245.8kB][41]

è¯¾ç¨‹ç»™å‡ºçš„å»ºè®®æ˜¯å°†5,000ç”¨æˆ·æ•°æ®æ”¾åˆ°è®­ç»ƒç»“åˆï¼Œå¦å¤–5,000ç”¨æˆ·æ•°æ®å¹³å‡åˆ†åˆ°dev/testä¸Šã€‚è¿™æ ·å­å¯ä»¥ä¿è¯dev/testæœ‰è¶³å¤Ÿæ˜ç¡®çš„ç›®æ ‡ï¼šç”¨æˆ·æ¨¡ç³Šå›¾ç‰‡çš„è¯†åˆ«ã€‚è€Œå¦‚æœå°†æ‰€æœ‰æ•°æ®shuffleå†åˆ†é…åˆ°dev/testï¼Œå­˜åœ¨çš„é—®é¢˜æ˜¯dev/testä¸Šæ•°æ®å¾ˆå¤§ä¸€éƒ¨åˆ†æ˜¯é«˜æ¸…æ•°æ®ï¼Œè¿›è€Œå‡å°äº†æ‹Ÿåˆç›®æ ‡çš„æ˜ç¡®æ€§ã€‚

## Data Mismatch

å¦‚æœtraining erroræ˜¯1%ï¼Œè€Œdev erroræ˜¯10%ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥è¯´æ˜æ¨¡å‹overfittingå‘¢ï¼Ÿ
i
æŒ‰ç…§ä¹‹å‰çš„ç†è§£çœ‹èµ·æ¥æ˜¯çš„ï¼Œä½†è¿™éœ€è¦ä¸€ä¸ªå‰æï¼štrainingå’Œdevæ•°æ®åŒæºã€‚å¦‚æœtrainingå’Œdevæ•°æ®åˆ†å¸ƒå·®åˆ«å¾ˆå¤§ï¼Œå°±ä¸èƒ½å¤Ÿè¯´æ˜é—®é¢˜ã€‚ä½¿ç”¨æ§åˆ¶å˜é‡æ³•è¿›è¡Œåˆ†æï¼Œä»trainingä¸­æå–ä¸€å°éƒ¨åˆ†åšä¸ºtraining-devé›†åˆï¼Œç”¨å…¶æ¥éªŒè¯æ˜¯å¦æœ‰overfittingï¼š

![image_1cbtb1qm61c51g807ko1hphiv5ba.png-66.7kB][42]

å¦‚æœè¿™æ—¶training-dev erroræ˜¯9%ï¼Œè¯´æ˜æ²¡æœ‰è®­ç»ƒçš„åŒæºæ•°æ®éƒ½æ²¡æœ‰æ‹Ÿåˆå¥½ï¼Œè¿™æ‰è¯´æ˜overfittingäº†ã€‚å¦‚æœtraining-dev erroræ˜¯1.5%ï¼Œé‚£è¯´æ˜æ›´å¤šçš„è¯¯å·®æ˜¯å› ä¸ºtrainingå’Œdevæ•°æ®ä¹‹å‰ä¸åŒåˆ†å¸ƒå¯¼è‡´ï¼Œè¿™ä¸ªè¯¯å·®å«åšã€Œdata mismatchã€ã€‚

ä¸‹å›¾æ˜¯ä¸€ä¸ªæ›´å…¨é¢çš„åˆ†æè¯¯å·®çš„çŸ©é˜µï¼Œå°†æ•°æ®åˆ†ä¸ºgeneralå’Œuser-caseä¸¤ä¸ªç»´åº¦ï¼Œå°†è¯¯å·®åˆ†ä¸ºhuman-levelã€è®­ç»ƒåˆ°æ•°æ®ã€æ²¡æœ‰è®­ç»ƒåˆ°çš„æ•°æ®ä¸‰ä¸ªç»´åº¦ï¼š

![image_1cbtb3gpchb7d191cll174cu0c4.png-76.3kB][43]

é‚£ä¹ˆå¦‚ä½•è§£å†³data-mismatchå‘¢ï¼Ÿæ²¡æœ‰ç‰¹åˆ«ç³»ç»Ÿçš„è§£å†³æ–¹æ³•ï¼Œä½†æœ‰ä¸€äº›ç­–ç•¥å¯ä»¥å‚è€ƒï¼š

- error analysisã€‚å…·ä½“é—®é¢˜å…·ä½“åˆ†æï¼Œçœ‹çœ‹å“ªäº›ç‚¹å¯¼è‡´äº†é—®é¢˜ã€‚
- å°†è¯†åˆ«é”™è¯¯çš„ç”¨ä¾‹åŠ å…¥åˆ°è®­ç»ƒé›†åˆä¸­ã€‚
- äººå·¥åˆæˆæ³•æ‰©å±•é”™è¯¯ç”¨ä¾‹ã€‚

æ¯”å¦‚è€ƒè™‘åˆæˆæœ‰å™ªå£°çš„è¯­éŸ³ï¼š

![image_1cbtbnipgnocm83set1ef01100ch.png-106.8kB][44]

è¯¾ç¨‹ä¸­è¯´ï¼Œåˆæˆæ–¹æ³•åœ¨å®é™…å·¥ç¨‹ä¸­çœŸçš„å¯ä»¥è§£å†³é—®é¢˜ï¼ä½†ä¹Ÿå­˜åœ¨ä¸€å®šçš„é£é™©ï¼šå¦‚æœå™ªå£°æ•°æ®è§„æ¨¡å¾ˆå°ï¼Œè€Œéœ€è¦åˆæˆçš„æ•°æ®å¾ˆå¤šï¼Œæ¨¡å‹çš„è®­ç»ƒç»“æœå¯èƒ½ä¼šå¯¹å™ªå£°æ•°æ®overfittingã€‚å¯¹äºäººè€Œè¨€ï¼Œç”¨ä¸å¤šçš„å™ªå£°æ•°æ®åˆæˆå°±å¯ä»¥æ¬ºéª—è€³æœµï¼Œä½†è¿™ç‚¹ä¸Šï¼Œæœºå™¨å´æ›´ä¸å®¹æ˜“æ¬ºéª—ã€‚

## Learning from multiple tasks

ç¥ç»ç½‘ç»œä¹‹æ‰€ä»¥å¾ˆæœ‰ç”¨ï¼Œå…¶ä¸­ä¸€ä¸ªåŸå› æ˜¯å› ä¸ºå¯ä»¥**è¿ç§»å­¦ä¹ **ï¼ˆè¯¾ç¨‹ä¸­æœ‰ä¸€ä¸ªè§†é¢‘æ˜¯é‡‡è®¿[Yoshua Bengio][45]ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªé—®é¢˜æ˜¯é—®ä»–ä¸ºä»€ä¹ˆåšæŒç ”ç©¶ç¥ç»ç½‘ç»œã€‚Bengioçš„å›ç­”æ˜¯ï¼Œä»–è§‰å¾—é€ ç‰©é€»è¾‘ä¸€å®šæ˜¯éå¸¸ç®€å•çš„å…¬å¼å°±å¯ä»¥æè¿°çš„ï¼Œå°±åƒæµä½“åŠ¨åŠ›æ–¹ç¨‹ï¼Œéº¦å…‹æ–¯éŸ¦æ–¹ç¨‹ï¼Œæ­£æ€åˆ†å¸ƒï¼Œæœ‰ç€æå…¶ç®€å•çš„å½¢å¼å’Œæ•°å­¦çš„ç¾ã€‚AIçš„æ¨¡å‹åº”è¯¥æ˜¯è¶³å¤Ÿç®€å•ä¸”é€šç”¨çš„ï¼Œå¯ä»¥è‡ªæˆ‘å­¦ä¹ ã€‚ä»è¿™ç‚¹ä¸Šçœ‹ï¼Œç¥ç»ç½‘ç»œç¡®å®æ˜¯ç›®å‰æœ€ä½“ç°ç®€å•å’Œé€šç”¨ä¹‹æ¦‚å¿µçš„æ¨¡å‹ï¼‰ã€‚

è¿ç§»å­¦ä¹ çš„æ¦‚å¿µæ˜¯å¯ä»¥å°†ä¸€ä¸ªé¢†åŸŸçš„ç½‘ç»œè¿ç§»åˆ°å¦å¤–ä¸€ä¸ªé¢†åŸŸï¼š

![image_1cbteou5l47env11fal1uajjhdeu.png-149.8kB][46]

æ¯”å¦‚ä¸Šå›¾ï¼Œåœ¨æœ€åçš„è¾“å‡ºç¯èŠ‚è¿›è¡Œã€Œfine-tuningã€ï¼Œå¤ç”¨ä¹‹å‰ã€Œpre-trainingã€çš„æ¨¡å‹ã€‚å›¾ä¸­æåˆ°çš„ä¾‹å­æ˜¯å°†è¯†åˆ«çŒ«çš„ç½‘ç»œè¿ç§»åˆ°è¯†åˆ«ç‹—ä¸­ï¼›å°†é€šç”¨è¯­éŸ³è¯†åˆ«è¿ç§»åˆ°triggerè¯­éŸ³çš„è¯†åˆ«ä¸­ï¼ˆå”¤é†’è®¾å¤‡ã€Œhi Siriã€ï¼‰

ä»€ä¹ˆæƒ…å†µä¸‹ä»ä»»åŠ¡Aè½¬ç§»åˆ°ä»»åŠ¡Bæ˜¯æœ‰æ•ˆçš„ï¼š

- ä»»åŠ¡Aå’ŒBæœ‰ç›¸åŒçš„è¾“å…¥ã€‚
- ä»»åŠ¡Açš„æ•°æ®æ¯”ä»»åŠ¡Bå¤šã€‚
- ä»»åŠ¡Açš„ä½ç»´åº¦æ•°æ®å¯¹å­¦ä¹ ä»»åŠ¡Bæ˜¯æœ‰æ„ä¹‰çš„ã€‚

å¦å¤–ä¸€ä¸ªç»´åº¦çš„å­¦ä¹ æ˜¯å¤šä»»åŠ¡å­¦ä¹ ï¼Œä¸€ä¸ªç½‘ç»œåŒæ—¶å­¦ä¹ å¤šä¸ªä»»åŠ¡ï¼š

![image_1cbtfs2p5uragnk17mb5gi1mepfb.png-155.1kB][47]

è¿™å’Œå¤šç±»åˆ«è¯†åˆ«ä¸ä¸€æ ·ï¼Œå¤šä»»åŠ¡çš„è¾“å‡ºç»“æœä¸­å¯èƒ½åŒæ—¶æœ‰å¤šä¸ª1ã€‚æ¯”å¦‚ä¸Šå›¾çš„è¾“å‡ºå°±æœ‰ï¼šæ˜¯å¦æœ‰è¡Œäººã€æ±½è½¦ã€åœæ­¢æ ‡å¿—ã€çº¢ç»¿ç¯ã€‚æ‰€ä»¥å¤šä»»åŠ¡è¯†åˆ«ä¸ä½¿ç”¨softmaxè¿›è¡Œæœ€åçš„losså‡½æ•°è®¡ç®—ï¼Œè€Œæ˜¯ç›´æ¥ç»Ÿè®¡æ‰€æœ‰ä»»åŠ¡çš„logesticæ•°å€¼ã€‚

ä»€ä¹ˆæƒ…å†µä¸‹å¤šä»»åŠ¡å­¦ä¹ æ˜¯æœ‰æ•ˆçš„ï¼š

1. æ‰€æœ‰è®­ç»ƒçš„ä»»åŠ¡éƒ½æœ‰å…±æ€§çš„ä½é˜¶ç‰¹æ€§ã€‚
2. ï¼ˆé€šå¸¸è€Œè¨€ï¼‰æ¯ä¸ªä»»åŠ¡çš„è®­ç»ƒæ•°æ®é‡ç›¸ä¼¼ã€‚ï¼ˆå¦‚æœæœ‰äº›ä»»åŠ¡æ•°æ®ç‰¹åˆ«å¤šï¼Œè®­ç»ƒå¯èƒ½å¯¹è¯¥ä»»åŠ¡è¿‡åº¦æ‹Ÿåˆï¼Œè¿›è€Œå½±å“äº†å…¶ä»–ä»»åŠ¡çš„è¯†åˆ«ï¼‰
3. éœ€è¦éå¸¸å¤§çš„è®­ç»ƒç½‘ç»œã€‚ï¼ˆå¤šä»»åŠ¡å­¦ä¹ ç½‘ç»œåœ¨è¶³å¤Ÿå¤§æ—¶ï¼Œæ•ˆæœå¹¶ä¸ä¼šæ¯”å•ç‹¬è®­ç»ƒä»»åŠ¡æ¨¡å‹å¾—åˆ°çš„ç»“æœå·®ã€‚ï¼‰

## End-to-end deep learning

end-to-end learningæ˜¯æŒ‡ç›´æ¥å°†è¾“å…¥å’Œè¾“å‡ºå»ºç«‹æ˜ å°„å…³ç³»çš„å­¦ä¹ ï¼Œè€Œä¸æ˜¯éœ€è¦å°†é—®é¢˜åˆ†è§£ä¸ºå¤šä¸ªæ­¥éª¤ã€‚

è€ƒè™‘è¯­éŸ³è¯†åˆ«ç³»ç»Ÿï¼šåœ¨æ²¡æœ‰dlä¹‹å‰çš„ç ”ç©¶æ˜¯å°†è¯­éŸ³è¿›è¡Œç‰¹å¾åˆ†å‰²ï¼Œè¯æ³•åˆ†æï¼Œè¯­ä¹‰åˆ†æç­‰ç¯èŠ‚ï¼Œç„¶åå¯¹è¾“å‡ºç»“æœè¿›è¡Œç¿»è¯‘ï¼Œä½†æœ€åå‘ç°æ•ˆæœåè€Œä¸å…¥ç›´æ¥end-to-endå­¦ä¹ æ•ˆæœå¥½ï¼š

![image_1cbto7ltdnou4nm1iic2dplui8.png-52.6kB][48]

è€ƒè™‘å¦å¤–ä¸€ä¸ªå¼•ç”¨åœºæ™¯ï¼Œäººè„¸è¯†åˆ«ï¼Œè¯¥é—®é¢˜å´ä¸æ˜¯end-to-endæ•ˆæœæ›´å¥½ï¼š

![image_1cbtof8191d5bpe91p0h1ts1uc6k5.png-235kB][49]

äººè„¸è¯†åˆ«åˆ†ä¸ºä¸¤ä¸ªè¿‡ç¨‹ï¼š1ï¼‰æ‰¾åˆ°äººè„¸ 2ï¼‰å°†äººè„¸å›¾ç‰‡ç¼©æ”¾ï¼ŒåŒ¹é…äººå‘˜ä¿¡æ¯ã€‚

åªæ‰€ä»¥åˆ†è€Œæ²»ä¹‹æ›´é€‚ç”¨äºäººè„¸è¯†åˆ«ï¼Œæœ‰å‡ ä¸ªåŸå› ï¼š

- æ¯ä¸ªå•ç‹¬çš„é—®é¢˜éƒ½æœ‰å¾ˆå¤šçš„æ•°æ®ã€‚æ¯”å¦‚ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¯ä»¥å¾ˆå¿«çš„åˆ©ç”¨ç°æœ‰æ•°æ®å’Œç ”ç©¶æˆæœå¾—åˆ°ä¸é”™çš„ç»“æœã€‚
- äººç±»é¢†åŸŸçŸ¥è¯†ä½“ç°äº†æ›´æ˜æ˜¾çš„æ­¥éª¤ã€‚ï¼ˆç›¸æ¯”äºè¯­éŸ³è¯†åˆ«æ„é€ çš„ç†è§£æ¨¡å¼ï¼Œäººè„¸è¯†åˆ«æ„é€ çš„æ­¥éª¤æ›´æœ‰æŠŠæ¡ï¼‰
- end-to-endçš„æ•°æ®ä¸å¤šã€‚ï¼ˆè€ƒè™‘ç›´æ¥ä»å›¾ç‰‡è®­ç»ƒè¯†åˆ«äººå‘˜ä¿¡æ¯ï¼Œéœ€è¦è¯†åˆ«äººå‘˜åœ¨å„ç§è§’åº¦ä¸Šå‡¹é€ å‹ï¼Œæ•°æ®é‡‡é›†æˆæœ¬é«˜ï¼‰

æ‰€ä»¥ï¼Œæ€»ç»“ä¸€ä¸‹end-to-endæ¨¡å¼çš„ä¼˜ç¼ºç‚¹ï¼š

|Pro|Con|
|:-:|:-:|
|æ•°æ®è‡ªæˆ‘è¡¨è¾¾å†…éƒ¨é€»è¾‘ã€‚| æ›´å°‘äººä¸ºè®¾è®¡çš„æ­¥éª¤ã€‚|
|éœ€è¦è¶³å¤Ÿå¤šçš„æ•°æ®æ‰æœ‰æ›´å¥½æ•ˆæœã€‚| ç¼ºå°‘å¯èƒ½æœ‰ç”¨çš„äººç±»é¢†åŸŸç»éªŒçŸ¥è¯†ã€‚ |

æ¢ä¸ªè§’åº¦è€ƒè™‘ï¼Œæœºå™¨å­¦ä¹ çš„æœ¬è´¨æ˜¯é€šè¿‡æ•°æ®è·å–çŸ¥è¯†ã€‚ä¸€ç§çŸ¥è¯†æ˜¯æ— è¡Œä¸ºæ¨¡å¼çš„ï¼Œé€šè¿‡è¶³å¤Ÿå¤šçš„æ•°ä»¥è®­ç»ƒå¾—åˆ°ï¼›å¦å¤–ä¸€ç§çŸ¥è¯†æ˜¯æœ‰è¡Œä¸ºæ¨¡å¼çš„ï¼Œæ˜¯äººç±»ç»éªŒçš„å»¶ä¼¸ï¼Œåˆ©ç”¨è¿™ç§çŸ¥è¯†å¯ä»¥åŠ é€Ÿæœºå™¨å­¦ä¹ çš„è¿‡ç¨‹ã€‚æ‰€ä»¥ç»¼åˆè€Œè¨€ï¼Œå…³é”®é—®é¢˜æ˜¯**æ˜¯å¦æœ‰è¶³å¤Ÿå¤šçš„æ•°æ®**ã€‚

å…¶å®åœ¨å¤æ‚çš„mlé¢†åŸŸï¼Œéƒ½æ˜¯æ··åˆä½¿ç”¨end-to-endå’Œhand-designing componentsä¸¤ç§æ¨¡å¼ã€‚

# Convolutional Neural Networks

## Concept of CNN

å·ç§¯æ“ä½œåœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸç”¨çš„éå¸¸å¤šï¼Œå…¶æ ¸å¿ƒæ˜¯ç”¨ä¸€ä¸ª$f \times f$å¤§å°çš„æ–¹å—filter/kernelå¯¹å›¾åƒå—çŠ¶åŒºåŸŸè¿›è¡ŒåŠ æƒè¿ç®—ï¼Œè¿›è€Œæå–å›¾åƒé«˜é˜¶ç‰¹å¾ï¼š

![Convolution_schematic.gif-63.6kB][50]

å·ç§¯æ“ä½œä¸­æœ‰ä¸€ä¸ªæ§åˆ¶å‚æ•°ï¼š

- $f$è¡¨ç¤ºå·ç§¯å¤§å°ï¼Œä¸€èˆ¬æ˜¯å¥‡æ•°
- $p$è¡¨ç¤ºå¡«å……å¤§å°ï¼Œä¸å¡«å……æ•°æ®çš„è¯ï¼Œå·ç§¯ä¼šè¶Šç®—è¶Šå°ï¼ŒåŒæ—¶å»æ‰äº†è¾¹ç¼˜çš„ä¿¡æ¯ã€‚
- $s$è¡¨ç¤ºæ¯æ¬¡æ“ä½œç§»åŠ¨å¤§å°ï¼Œé»˜è®¤ä¸º1ã€‚
- å·ç§¯æ“ä½œä¹‹åçš„é•¿åº¦ä¸º$\lfloor{\frac {n+2p-f}{s}}\rfloor + 1$

å°†å·ç§¯æ“ä½œåšä¸ºæå–ç‰¹å¾çš„æ ¸å¿ƒæ“ä½œï¼Œç±»æ¯”åˆ°ç¥ç»ç½‘ç»œæ¨¡å‹ä¸­ï¼Œå°±å¾—åˆ°äº†å·ç§¯ç¥ç»ç½‘ç»œã€‚

åœ¨CNNä¸­ï¼Œfilteræ˜¯æœ‰ç¬¬ä¸‰ç»´åº¦çš„ï¼ŒåŠ åšchannelï¼Œè¯¥channelçš„å¤§å°å°±ç­‰äºä¸Šä¸€å±‚è¾“å…¥çš„èŠ‚ç‚¹æ•°ï¼ˆç±»æ¯”äºNNä¸­çš„$W$ç¬¬ä¸€ç»´åº¦æ˜¯ä¸Šå±‚èŠ‚ç‚¹ä¸ªæ•°ï¼‰ï¼Œç„¶åå°†å„ä¸ªchannelçš„filterå’Œä¸Šä¸€å±‚èŠ‚ç‚¹æ•°æ®ä¾æ¬¡è¿ç®—ï¼Œæœ€ååŠ æƒç»Ÿä¸€ï¼Œå¾—åˆ°æœ¬å±‚çš„**ä¸€ä¸ªç‰¹å¾**ã€‚æ¯”å¦‚ä¸‹å›¾å°±æ˜¯å¯¹åŸå§‹è¾“å…¥çŸ©é˜µ(R,G,Bä¸‰ä¸ªé€šé“)æ•°æ®è¿›è¡Œä¸€æ¬¡å·ç§¯æ“ä½œï¼Œå¾—åˆ°æ–°çš„ç‰¹å¾ï¼š

![image_1cbuidcbbscnep8ujgj351mc2lv.png-150.5kB][51]

å¦‚æœä½¿ç”¨å¤šä¸ªfilterï¼Œå°±å¯ä»¥å¾—åˆ°æœ¬å±‚çš„Nä¸ªç‰¹å¾ï¼š

![image_1cbuidmfb1b3k1ucu1qu21p3l1bsfmc.png-151.9kB][52]

å…¶æ“ä½œè¿‡ç¨‹åŠ¨ç”»å±•ç¤ºå¦‚ä¸‹ï¼š

<center><video width="620" height="440" src="/videos/conv_kiank.mp4" type="video/mp4" controls></video></center>

CNNä¸­ç¬¦å·è¯´æ˜ï¼ˆè¯•ç”¨äº†ä¸€ä¸‹å°è±¡ç¬”è®°çš„æ–‡æ¡£æ‰«æåŠŸèƒ½ï¼Œå¾ˆèµï¼‰ï¼š

![Evernote Snapshot 20180425 215537.png-212.5kB][53]

ä¸Šé¢ä»‹ç»çš„ç½‘ç»œåœ¨CNNä¸­å«åšConvolutional Layerï¼ˆå·ç§¯ç½‘ç»œï¼‰ã€‚å¦å¤–è¿˜æœ‰ä¸¤ç§å½¢å¼çš„Layerï¼Œä¸€ä¸ªå«åšPooling Layerï¼š

![image_1cbui79q97m4iuk15cfsid16l9li.png-107.7kB][54]

Pooling Layerå¯¹æ¯ä¸€ä¸ªchannelæ•°æ®åˆ†åˆ«å¤„ç†ï¼Œæå–æœ€å¤§å€¼ï¼ˆå‡å€¼ï¼Œç”¨çš„æ¯”è¾ƒå°‘ï¼‰ï¼Œæˆ–è€…æ¢ä¸ªç†è§£ï¼Œæå–æœ€å¤§ç‰¹å¾ï¼ŒåŒæ—¶é™ç»´æ•°æ®ã€‚æ‰€ä»¥pool layerå’Œconv layerä¸ä¸€æ ·ï¼Œæ²¡æœ‰å‚æ•°ï¼ˆåªæœ‰hypterparameterï¼Œå·ç§¯ç”¨çš„filter/padding/stride sizeï¼‰ï¼ŒåŒæ—¶ï¼Œæ˜¯å¯¹æ¯ä¸€ä¸ªchannelå•ç‹¬å¤„ç†ï¼Œä¸æ”¹å˜è¾“å…¥æ•°æ®çš„ä¸ªæ•°ã€‚

è¿˜æœ‰ä¸€ä¸ªlayerå«åšFully Connected layer(FC)ï¼Œå°±æ˜¯åŸæ¥çš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œæ²¡æœ‰å·ç§¯è¿ç®—ï¼Œç›´æ¥çš„æƒé‡çŸ©é˜µWè¿›è¡Œæ˜ å°„ï¼Œä¸€èˆ¬ç”¨åœ¨ç½‘ç»œçš„æœ€åé˜¶æ®µï¼Œä½¿ç”¨softmaxè¾“å‡ºç±»åˆ«ã€‚

æ‰€ä»¥ï¼Œç»¼åˆèµ·æ¥ï¼Œä¸€ä¸ªCNNæ¨¡å‹çš„ä¾‹å­ï¼š

![image_1cbujeov31q2m1bn87g913fte7pn6.png-165.5kB][55]
![image_1cbujllnsen81r4mom164b13kjnj.png-121.3kB][56]

ä¸€èˆ¬è€Œè¨€ï¼ŒCNNçš„æ¨¡å¼æ˜¯åœ¨å‰å‡ å±‚å°†å›¾åƒç»´åº¦ç¼©å°ï¼ˆæå–æ›´æŠ½è±¡ä¿¡æ¯ï¼‰ï¼ŒåŒæ—¶ï¼Œæé«˜ç‰¹å¾ä¸ªæ•°ï¼ˆé«˜é˜¶ç‰¹å¾ï¼‰ã€‚

è‡³äºä¸ºå•¥CNNæœ‰æ•ˆï¼Œè¯¾ç¨‹ä¸­è¯´æ˜¯æœ‰ä¸¤ç‚¹ï¼š1ï¼‰parameter sharingï¼Œå¦‚æœä¸€ä¸ªfilterå¯¹å›¾åƒçš„å±€éƒ¨æœ‰æ•ˆï¼Œå¯èƒ½ä¹Ÿå¯¹å…¨å±€æœ‰æ•ˆ 2ï¼‰sparsity of connectionsï¼Œæƒé‡çŸ©é˜µå˜å°äº†å¾ˆå¤šï¼Œæ¯”NNèŠ‚ç‚¹ä¹‹é—´è¿æ¥çŸ©é˜µå°å¤ªå¤šã€‚

è€Œæˆ‘ä¸ªäººç†è§£ï¼Œå¯èƒ½CNNæ›´å¥½å¾—æ¨¡æ‹Ÿäº†å¤§è„‘å¤„ç†è§†è§‰çš„æ¨¡å¼ï¼ˆä¸ªäººç†è§£ï¼‰ï¼š

- å¤§è„‘å¯¹å›¾åƒæ˜¯æ‰«æåˆ†æçš„ï¼Œä¸€å—ä¸€å—æ‰«æï¼Œç„¶åå¾—åˆ°å…¨å±€ä¿¡æ¯ã€‚
- æ‰«æå®Œæˆåï¼Œå¯¹å›¾åƒçš„ç‚¹ï¼Œçº¿ï¼Œé¢è¿›è¡Œæ‹†åˆ†ï¼Œç»„è£…ï¼Œå®šä½ç›®æ ‡ã€‚
- å®šä½åç„¶åè¯†åˆ«ï¼Œç†è§£ã€‚

æˆ‘ç†è§£CNNå°±æ˜¯åœ¨æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ã€‚æœ€æœ‰è¶£çš„éƒ¨åˆ†å°±æ˜¯å°†filterå˜æˆå‚æ•°æ±‚è§£ï¼Œç›¸æ¯”äºä»¥å‰çš„è§†è§‰ç®—æ³•éƒ½æ˜¯**æ‰‹å·¥è°ƒæ•™**å‚æ•°ã€‚äººè„‘å¯¹äºæ¨¡å¼çš„è¯†åˆ«ï¼Œåº”è¯¥æ˜¯éå¸¸çµæ´»çš„ï¼Œç›®æ ‡å¯¼å‘ä¸”è‡ªé€‚åº”çš„ï¼Œå¯åæœŸè®­ç»ƒçš„ã€‚æ‰€ä»¥CNNçš„æ¨¡å¼ç¡®å®æ›´åƒäººç±»ä¸€äº›ã€‚

## CNN Architecture

æŠ½è±¡æ¥è¯´ï¼ŒNNå­¦ä¹ çš„å°±æ˜¯çŸ¥è¯†ã€‚çŸ¥è¯†åˆ†ä¸¤ç§ï¼šä¸€ç§æ¥è‡ªäºæ•°æ®ï¼Œä¸€ç§æ¥è‡ªäºäººç±»ç»éªŒæ¨¡å‹ã€‚ç†è®ºä¸Šè¯´ï¼Œåœ¨æ•°æ®è¶³å¤Ÿå¤šï¼ˆç›¸å¯¹äºé—®é¢˜çš„å¤æ‚ç¨‹åº¦ï¼‰ï¼Œè®¡ç®—èƒ½åŠ›è¶³å¤Ÿå¤§æ—¶ï¼Œæœ€å¥½çš„æ¨¡å‹ä¸éœ€è¦äººä¸ºå¹²é¢„ï¼Œç›´æ¥é€šè¿‡æ•°æ®è·å¾—çŸ¥è¯†ã€‚ä½†åœ¨æ•°æ®ä¸å¤šï¼Œè®¡ç®—èƒ½åŠ›ä¸å¤Ÿæ—¶ï¼Œå°±éœ€è¦äººä¸ºå¹²é¢„æ¨¡å‹æ¥æé«˜å­¦ä¹ é€Ÿåº¦ï¼Œæé«˜å­¦ä¹ æ•ˆæœã€‚

### VGG - 16

![image_1cc0mqv8dra51nql16831jlq83i4g.png-167.8kB][57]

è¿™ä¸ªæ¨¡å‹æ¯”è¾ƒæ—©ï¼Œæ¯”ä»·æœ‰æ„æ€çš„æ˜¯ï¼Œæ¯ä¸€å±‚è®¡ç®—åï¼Œå›¾åƒé•¿å’Œå®½éƒ½ç¼©å°ä¸€å€ï¼Œä½†ç‰¹å¾å¤šäº†ä¸€å€ï¼Œæœ‰éå¸¸ç»Ÿä¸€çš„æ¨¡å‹ç»“æ„ã€‚

### ResNet

åœ¨ResNetå‡ºç°ä¹‹å‰ï¼Œè®­ç»ƒæ·±å±‚æ¬¡ç½‘ç»œå­˜åœ¨ä¸€ä¸ªå·¨å¤§çš„é—®é¢˜ï¼švanishing gradientsã€‚å°±æ˜¯éšç€æ•°æ®çš„è¿­ä»£ï¼Œæƒé‡è¶Šæ¥è¶Šå°ï¼Œbackpropè®¡ç®—æ—¶ï¼Œæ¢¯åº¦ä¼šè¶Šæ¥è¶Šå°ï¼ˆæ¢¯åº¦éœ€è¦ä¹˜ä»¥æƒé‡ï¼Œè€Œæƒé‡è¶Šæ¥è¶Šå°ï¼Œåœ¨ç»è¿‡å¤šå±‚ç½‘ç»œçš„è®¡ç®—åï¼Œæ¢¯åº¦å‘ˆæŒ‡æ•°ç¼©å°ï¼‰ï¼Œæ¢¯åº¦ç¼©å°å°±ä¼šå¯¼è‡´è®­ç»ƒè¶Šæ¥è¶Šæ…¢ï¼š

![image_1cc0ola5e1efq199e1qsvnp1rbhl.png-225.4kB][58]

ResNetæ ¸å¿ƒæ€è·¯æ˜¯æ„é€ ã€Œskip connectionã€ï¼Œåœ¨åŸæœ‰çš„è¿æ¥åŸºç¡€ä¸Šï¼Œæ„é€ çŸ­è·¯ï¼ˆshortcutï¼‰çš„è¿æ¥ï¼š

![Evernote Snapshot 20180426 182650.png-498kB][59]

çŸ­è·¯ä¹‹åæœ‰ä¸ªç‰¹æ€§ï¼Œå¦‚æœä¸­é—´èŠ‚ç‚¹çš„æƒé‡ç³»æ•°ä¸º0ï¼Œé‚£ä¹ˆL+2å±‚çš„è¾“å‡ºå°±æ˜¯Lå±‚çš„è¾“å‡ºï¼Œè¿™å‡ ä¸ªç½‘ç»œæ„æˆäº†ä¸€ä¸ªIdentity Layerã€‚

æˆ‘ä¸ªäººç†è§£ResNetå¯ä»¥æœ‰æ•ˆå·¥ä½œçš„åŸå› ç”»åœ¨äº†ä¸Šå›¾ä¸­ã€‚ç‰¹å¾çš„æŠ½è±¡å±‚æ¬¡è‚¯å®šä¸ä¼šå®Œå…¨ç›¸åŒï¼Œæœ‰çš„ç‰¹å¾ç»´åº¦é«˜ï¼Œæœ‰çš„ç»´åº¦ä½ã€‚å¦‚æœç½‘ç»œç‰¹åˆ«æ·±ï¼Œä¼šå¯¼è‡´ä½ç»´åº¦ç‰¹å¾è¿˜æ²¡è¿è¡Œåˆ°æœ€åä¸€å±‚å°±å·²ç»æœ€ä¼˜æ”¶æ•›ï¼Œä¹‹åå†è®¡ç®—åè€Œå¯¼è‡´overfittingã€‚ä½†å¦‚æœç½‘ç»œä¸æ·±ï¼Œé«˜ç»´åº¦ç‰¹å¾åˆä¸æ”¶æ•›ã€‚æ‰€ä»¥æˆ‘è§‰å¾—ResNetå¹²çš„å°±æ˜¯è¿™ä¸ªäº‹æƒ…ï¼š**è®©ä½çº¬åº¦ç‰¹å¾è®¡ç®—æ”¾ç¼“ï¼Œç­‰ç€é«˜çº¬åº¦ç‰¹å¾ä¸€èµ·æ”¶æ•›ã€‚**ï¼ˆshortcutå¯¼è‡´ä¸­é—´çš„è®¡ç®—éƒ½æ²¡æœ‰ç”¨ï¼Œç­‰ä»·äºæ”¾ç¼“é€Ÿåº¦ã€‚ï¼‰

### Inception network

Inceptionç½‘ç»œå¦‚å…¶å­—é¢æ„æ€ï¼Œå¯ä»¥è‡ªæˆ‘ã€Œæ„ŸçŸ¥ã€è®¡ç®—ï¼Œå°±æ˜¯è‡ªåŠ¨è®¡ç®—å‡ºhypoparametersã€‚æ—¢ç„¶æ¨¡å‹çš„filterå°ºå¯¸éœ€è¦äººä¸ºè®¾å®šï¼Œå­˜åœ¨ä¸ç¡®å®šæ€§ã€‚é‚£ä¹ˆå¹²è„†ç›´æ¥éå†å‡ ä¸ªå¸¸ç”¨å°ºå¯¸å¾—åˆ°çš„ç»“æœï¼Œéƒ½å°†å…¶æ”¾åˆ°ç½‘ç»œä¸­è®¡ç®—ï¼Œè®©ç³»ç»Ÿè‡ªåŠ¨ã€Œæ„ŸçŸ¥ã€ã€‚

![image_1cc096epo1bj61qe91o651ub419sp.png-115.1kB][60]

è¶Šè‡ªåŠ¨ï¼Œè¶Šéœ€è¦æ•°æ®ï¼Œè¶Šéœ€è¦è®¡ç®—é‡ã€‚inceptionç”¨äº†ä¸€ä¸ªæ–¹æ³•ï¼ˆè°ƒæ•´ç½‘ç»œæ¨¡å‹ï¼‰æ¥é™ä½è®¡ç®—å¤æ‚åº¦ï¼š

![image_1cc09lq78c4je7a1h2mdoa162g16.png-76.7kB][61]
![image_1cc09n7101dfh5qp142b1joj16i933.png-108.7kB][62]

å…¶æ ¸å¿ƒå°±æ˜¯å°†æ•°æ®å…ˆç»è¿‡ä¸€ä¸ª$1\times1$çš„å·ç§¯ç½‘ç»œï¼Œé™ä½channelæ·±åº¦ï¼Œç„¶ååœ¨æ‰§è¡Œåç»­è¿ç®—ã€‚æˆ‘ä¸ªäººç†è§£$1\times1$çš„å·ç§¯ç›®çš„å°±æ˜¯å¯¹åŸå§‹æ•°æ®è¿›è¡Œ**æ•´ç†ï¼Œå½’æ¡£**ï¼Œå°†ç±»ä¼¼çš„æ•°æ®æ•´ç†å½’ç±»åˆ°æ›´å°çš„ç±»åˆ«ä¸­ï¼Œç„¶åé™ä½è®¡ç®—é‡ã€‚

å­¦å®Œè¿™èŠ‚è¯¾ï¼Œæˆ‘çš„æ„Ÿå—å°±æ˜¯ï¼Œè¿™äº›æ¨¡å‹ç”¨åˆ°çš„magical numberç®€ç›´å°±æ˜¯ç§‘å­¦çš„è‰ºæœ¯ï¼Œè‰ºæœ¯çš„ç§‘å­¦ï¼Œç¥å¥‡çš„1b.


---


  [1]: https://www.coursera.org/learn/machine-learning
  [2]: /2018/04/11/ml/coursera-machine-learning-course-note/
  [3]: https://www.deeplearning.ai/
  [4]: https://www.coursera.org/learn/neural-networks-deep-learning
  [5]: http://mooc.study.163.com/learn/2001281002
  [6]: http://static.zybuluo.com/whiledoing/nujp3k3xxmomlbh5yfnqi57b/image_1cbjjlpbn131l5err5d1ipbh39.png
  [7]: http://static.zybuluo.com/whiledoing/qlupqb397psgao24at1y2b0b/image_1cbk9eq4khivnibo04st8o813.png
  [8]: http://static.zybuluo.com/whiledoing/tsy9tyd16bb78qzs462a4w74/image_1cbk4ja891dfi1c531s45bhc88km.png
  [9]: http://static.zybuluo.com/whiledoing/josxxrwtnd5cewwwgad8z9mw/image_1cblv2ga614fe1oeglfi17k91sng1t.png
  [10]: http://static.zybuluo.com/whiledoing/ksm5x616y4q7m3jvci8ps42n/image_1cbm0mlpgi4v2nu11sd1jsrii2q.png
  [11]: http://static.zybuluo.com/whiledoing/tezg7kf2ebpu6awzhw56ed4y/image_1cbm44tnu76l1o8o15lbul37q37.png
  [12]: http://static.zybuluo.com/whiledoing/a1xqv39ll11q8zpdplklhf9h/image_1cbm7fkfdjvq6uab5pt29bd3k.png
  [13]: http://static.zybuluo.com/whiledoing/8tza12fxrvvgu0glzyyb00gn/image_1cbn03ohnh10vcv11of12rfq6q5l.png
  [14]: /2018/04/11/ml/coursera-machine-learning-course-note/#implementation
  [15]: http://static.zybuluo.com/whiledoing/5bn1jsvadh6nsbeyw3iytfq7/image_1cbmp7t75mqa10v1141p1cm576141.png
  [16]: http://static.zybuluo.com/whiledoing/ugtt5xbnt8kazzzmzqpezprq/image_1cbmplc331tad1uh315nj1md81ph44e.png
  [17]: /2018/04/11/ml/coursera-machine-learning-course-note/#evaluating-improve
  [18]: http://static.zybuluo.com/whiledoing/2ae226uv5760sv1iii8wyowh/image_1cbo6rtme19a5m631qdf18ga1oo362.png
  [19]: http://static.zybuluo.com/whiledoing/wo7w0355gastpm2z03rva319/image_1cbo78s3ro0g1a7k1cdjur51l287f.png
  [20]: http://static.zybuluo.com/whiledoing/9jaijdjoi2e9k5s7lyzpb9ql/image_1cbo7mg97rvj4qdtv216mo1p9.png
  [21]: http://static.zybuluo.com/whiledoing/gaqcg9cfx6pea3eyn4c4mnqo/image_1cbo7uit316egjs39kr3jq17oa1m.png
  [22]: http://static.zybuluo.com/whiledoing/d88fwrw4a8ucigfzh16mh3sm/image_1cboj4tcs2vhj1ekodkkb144j2j.png
  [23]: http://static.zybuluo.com/whiledoing/lsyvu3ql36syfsit9gfjappb/image_1cbpf2kfiqv21cou13o018q61eeo9.png
  [24]: http://static.zybuluo.com/whiledoing/scgnkz6swme7ugekusawb04p/image_1cbojoo4b1alc1euu1om51i621l1c3d.png
  [25]: http://static.zybuluo.com/whiledoing/ojeb0o2fk6ebol3foacrjy5f/image_1cbokft2i6nf62m2t1757g293q.png
  [26]: /2018/04/11/ml/coursera-machine-learning-course-note/#using-large-datasets
  [27]: http://static.zybuluo.com/whiledoing/uubv2at389otlp95lcp8omi0/image_1cbpf5r8k1e2t24p1ejn1arv17eum.png
  [28]: http://static.zybuluo.com/whiledoing/rog7tie0r5ymolgjxjlzlg72/image_1cbpf7gsh14sg6jrarj95j1gmt1j.png
  [29]: http://static.zybuluo.com/whiledoing/wfudzoancvtvzc4rl123kwsk/image_1cbpfv6tq1ufrsklfmc1opdgoa20.png
  [30]: http://static.zybuluo.com/whiledoing/iy6ghf6kwpf4ba6s9hcc4go4/image_1cbph9agsv6g1obemg87bl1foa2d.png
  [31]: http://static.zybuluo.com/whiledoing/2dqw9wx3gud2xct8wd7evdms/image_1cbrb8m011brs1l0924j6s01kqr3k.png
  [32]: http://static.zybuluo.com/whiledoing/m2uuwm2e0y23s7mf0r8wlp69/image_1cbrbln261n1t18qmdfpsve1sos41.png
  [33]: http://static.zybuluo.com/whiledoing/gwrbd2icv4cbilvtma8izk1k/image_1cbrcd71v6fv3ve1sra1niq1c0g4e.png
  [34]: http://static.zybuluo.com/whiledoing/p42t7kxescioq84t6j04ns2x/image_1cbrdinvm65ofmn1k9e1jbq9j65o.png
  [35]: http://static.zybuluo.com/whiledoing/js89ocqevam5joxvy47uljog/image_1cbrdsdke9rn10s01ki8tcb1fcj65.png
  [36]: http://static.zybuluo.com/whiledoing/z7gdskms5rfou8secimvh1tj/image_1cbre3l0716i076214ectchkja6i.png
  [37]: /2018/04/11/ml/coursera-machine-learning-course-note/#evaluating-improve
  [38]: http://static.zybuluo.com/whiledoing/1qlldsme3u36md0vwvo2uaxv/image_1cbrpccuh7i52sm1m81790hct7c.png
  [39]: http://static.zybuluo.com/whiledoing/4nls7jr0b0ahis0uhmjzywm9/image_1cbrqgrnq7pr1j76fep8cts3p86.png
  [40]: http://static.zybuluo.com/whiledoing/2k2is644wg48ayfiq85d7td2/image_1cbt9ov0tcv6fai1ks21h981oavag.png
  [41]: http://static.zybuluo.com/whiledoing/olewzuab8292vne4wsyb538v/image_1cbt9nvqk1l3j9vq1guubmhudg8j.png
  [42]: http://static.zybuluo.com/whiledoing/wlto9zkoxotoqqp9ly2vmrf5/image_1cbtb1qm61c51g807ko1hphiv5ba.png
  [43]: http://static.zybuluo.com/whiledoing/xucwkbirvxbobsst8oybmath/image_1cbtb3gpchb7d191cll174cu0c4.png
  [44]: http://static.zybuluo.com/whiledoing/a1vqdiys08sh65gqzfjiav3q/image_1cbtbnipgnocm83set1ef01100ch.png
  [45]: https://www.wikiwand.com/zh-cn/%E7%BA%A6%E4%B9%A6%E4%BA%9A%C2%B7%E6%9C%AC%E5%B8%8C%E5%A5%A5
  [46]: http://static.zybuluo.com/whiledoing/wfglt8uyucz9wpwcouq53kjt/image_1cbteou5l47env11fal1uajjhdeu.png
  [47]: http://static.zybuluo.com/whiledoing/16djj0l616meyhnm0c1eysqb/image_1cbtfs2p5uragnk17mb5gi1mepfb.png
  [48]: http://static.zybuluo.com/whiledoing/jxjk5itor79t4706ugd05py6/image_1cbto7ltdnou4nm1iic2dplui8.png
  [49]: http://static.zybuluo.com/whiledoing/3qepvni8isycba1c4w8yd5bf/image_1cbtof8191d5bpe91p0h1ts1uc6k5.png
  [50]: http://static.zybuluo.com/whiledoing/bcdat9ykomleqmkfrng9k2oo/Convolution_schematic.gif
  [51]: http://static.zybuluo.com/whiledoing/4zqe8tl59egq5qx74t44pn3p/image_1cbuidcbbscnep8ujgj351mc2lv.png
  [52]: http://static.zybuluo.com/whiledoing/zb3erz2whbhro9us203vjadz/image_1cbuidmfb1b3k1ucu1qu21p3l1bsfmc.png
  [53]: http://static.zybuluo.com/whiledoing/zzo14jmcel00rqhqdorlug5k/Evernote%20Snapshot%2020180425%20215537.png
  [54]: http://static.zybuluo.com/whiledoing/7vy9tpz380uuu1tzkm9j6279/image_1cbui79q97m4iuk15cfsid16l9li.png
  [55]: http://static.zybuluo.com/whiledoing/a83u3qjo7hd16h7p1z4ajhe2/image_1cbujeov31q2m1bn87g913fte7pn6.png
  [56]: http://static.zybuluo.com/whiledoing/ndc8gbxsy0rcel10vysh82j2/image_1cbujllnsen81r4mom164b13kjnj.png
  [57]: http://static.zybuluo.com/whiledoing/0kkhajr4yadwtrae03ax6axa/image_1cc0mqv8dra51nql16831jlq83i4g.png
  [58]: http://static.zybuluo.com/whiledoing/0p9kqjd9sl5dvpni3lbdj33a/image_1cc0ola5e1efq199e1qsvnp1rbhl.png
  [59]: http://static.zybuluo.com/whiledoing/sirtthyilcuv3cx0mjzqh6of/Evernote%20Snapshot%2020180426%20182650.png
  [60]: http://static.zybuluo.com/whiledoing/a6nxvjxtv7xhmfd1xrolc9h2/image_1cc096epo1bj61qe91o651ub419sp.png
  [61]: http://static.zybuluo.com/whiledoing/ycm4g46twno8ee444loelecp/image_1cc09lq78c4je7a1h2mdoa162g16.png
  [62]: http://static.zybuluo.com/whiledoing/x0r3gmk84oj7t1ntf5bgivp4/image_1cc09n7101dfh5qp142b1joj16i933.png